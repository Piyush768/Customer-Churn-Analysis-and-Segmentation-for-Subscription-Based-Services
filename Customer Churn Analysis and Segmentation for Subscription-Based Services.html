<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>6ff897c02ced4534a0e020dd7ad3d108</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<div class="cell markdown" id="2jlabLy3fk5y">
<p>#Customer Analytics - Capstone Project</p>
</div>
<div class="cell markdown" id="IbkHJJZHfp0x">
<p>#Piyush Patil – 989468326</p>
</div>
<div class="cell markdown" id="9YDpow-3fuZu">
<p>#Enhancing Customer Retention in Telecom through churn Prediction and
Segmentation</p>
</div>
<div class="cell code" data-execution_count="16" id="2dl0QK8vWRlj">
<div class="sourceCode" id="cb1"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scipy.stats <span class="im">as</span> stats</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.stats.outliers_influence <span class="im">import</span> variance_inflation_factor</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> LabelEncoder, RobustScaler, StandardScaler</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split, GridSearchCV</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestClassifier, RandomForestRegressor</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> mean_squared_error, r2_score, classification_report, accuracy_score, confusion_matrix</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> imblearn.over_sampling <span class="im">import</span> SMOTE</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.models <span class="im">import</span> Sequential</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.layers <span class="im">import</span> Conv1D, MaxPooling1D, Flatten, Dense, Dropout, BatchNormalization</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.utils <span class="im">import</span> to_categorical</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> lightgbm <span class="im">import</span> LGBMClassifier</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.cluster <span class="im">import</span> KMeans</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> silhouette_score</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install scikit<span class="op">-</span>learn</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LogisticRegression</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="64"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:256}"
id="gDkHSy1815DA" data-outputId="03b9c9a3-dfbd-44f0-f063-85534ba5bbca">
<div class="sourceCode" id="cb2"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">&quot;/content/cell2celltrain.csv&quot;</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>df.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="64">

  <div id="df-5b405ea1-f389-4342-9a89-e4f061ae3c94" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CustomerID</th>
      <th>Churn</th>
      <th>MonthlyRevenue</th>
      <th>MonthlyMinutes</th>
      <th>TotalRecurringCharge</th>
      <th>DirectorAssistedCalls</th>
      <th>OverageMinutes</th>
      <th>RoamingCalls</th>
      <th>PercChangeMinutes</th>
      <th>PercChangeRevenues</th>
      <th>...</th>
      <th>ReferralsMadeBySubscriber</th>
      <th>IncomeGroup</th>
      <th>OwnsMotorcycle</th>
      <th>AdjustmentsToCreditRating</th>
      <th>HandsetPrice</th>
      <th>MadeCallToRetentionTeam</th>
      <th>CreditRating</th>
      <th>PrizmCode</th>
      <th>Occupation</th>
      <th>MaritalStatus</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3000002</td>
      <td>Yes</td>
      <td>24.00</td>
      <td>219.0</td>
      <td>22.0</td>
      <td>0.25</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>-157.0</td>
      <td>-19.0</td>
      <td>...</td>
      <td>0</td>
      <td>4</td>
      <td>No</td>
      <td>0</td>
      <td>30</td>
      <td>Yes</td>
      <td>1-Highest</td>
      <td>Suburban</td>
      <td>Professional</td>
      <td>No</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3000010</td>
      <td>Yes</td>
      <td>16.99</td>
      <td>10.0</td>
      <td>17.0</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>-4.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0</td>
      <td>5</td>
      <td>No</td>
      <td>0</td>
      <td>30</td>
      <td>No</td>
      <td>4-Medium</td>
      <td>Suburban</td>
      <td>Professional</td>
      <td>Yes</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3000014</td>
      <td>No</td>
      <td>38.00</td>
      <td>8.0</td>
      <td>38.0</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>-2.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0</td>
      <td>6</td>
      <td>No</td>
      <td>0</td>
      <td>Unknown</td>
      <td>No</td>
      <td>3-Good</td>
      <td>Town</td>
      <td>Crafts</td>
      <td>Yes</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3000022</td>
      <td>No</td>
      <td>82.28</td>
      <td>1312.0</td>
      <td>75.0</td>
      <td>1.24</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>157.0</td>
      <td>8.1</td>
      <td>...</td>
      <td>0</td>
      <td>6</td>
      <td>No</td>
      <td>0</td>
      <td>10</td>
      <td>No</td>
      <td>4-Medium</td>
      <td>Other</td>
      <td>Other</td>
      <td>No</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3000026</td>
      <td>Yes</td>
      <td>17.14</td>
      <td>0.0</td>
      <td>17.0</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>-0.2</td>
      <td>...</td>
      <td>0</td>
      <td>9</td>
      <td>No</td>
      <td>1</td>
      <td>10</td>
      <td>No</td>
      <td>1-Highest</td>
      <td>Other</td>
      <td>Professional</td>
      <td>Yes</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 58 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-5b405ea1-f389-4342-9a89-e4f061ae3c94')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-5b405ea1-f389-4342-9a89-e4f061ae3c94 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-5b405ea1-f389-4342-9a89-e4f061ae3c94');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-af21a80f-6b90-4e2b-bd10-bd58ecab78d9">
  <button class="colab-df-quickchart" onclick="quickchart('df-af21a80f-6b90-4e2b-bd10-bd58ecab78d9')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-af21a80f-6b90-4e2b-bd10-bd58ecab78d9 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

    </div>
  </div>

</div>
</div>
<div class="cell markdown" id="k4LHlm5fgDs-">
<p>Here is a brief description of some of the key columns from your
telecom churn dataset:</p>
<p>o Churn: Indicates if the customer has churned (left) or is
retained.</p>
<p>o Monthly Revenue: The revenue generated by each customer
monthly.</p>
<p>o Monthly Minutes: Total minutes of usage per month by the
customer.</p>
<p>o Total Recurring Charge: The total recurring charge for each
customer.</p>
<p>o Director Assisted Calls: The count of calls that required
assistance.</p>
<p>o Average Minutes: Minutes exceeding the allocated plan limit.</p>
<p>o Roaming Calls: Number of calls made while roaming.</p>
<p>o PercChange Minutes: Percentage change in the minutes of usage
compared to a previous period.</p>
<p>o PercChange Revenues: Percentage change in revenue for each
customer.</p>
<p>o Dropped Calls: Number of calls dropped during the period.</p>
<p>o Blocked Calls: Calls attempted but blocked due to network or other
issues.</p>
<p>o Customer Care Calls: Number of calls to customer care.</p>
<p>o Three-way Calls: Calls involving three participants.</p>
<p>o Months In Service: Number of months the customer has been in
service.</p>
<p>o Service Area: Geographical service area of the customer.</p>
<p>o Handsets: Number of handsets associated with the account.</p>
<p>o Income Group: Income group classification of the custome</p>
</div>
<div class="cell code" data-execution_count="18" id="iV2oybBq5lcY">
<div class="sourceCode" id="cb3"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.drop(<span class="st">&#39;CustomerID&#39;</span>, axis<span class="op">=</span><span class="dv">1</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="19"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:982}"
id="opg_tOrp5EP2" data-outputId="af4e4c5c-e67c-4d7e-8db3-03b30ddbb747">
<div class="sourceCode" id="cb4"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>df.hist(figsize<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">15</span>), bins<span class="op">=</span><span class="dv">30</span>, edgecolor<span class="op">=</span><span class="st">&#39;black&#39;</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>plt.suptitle(<span class="st">&quot;Distribution of All Columns&quot;</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_5cdade6e6d334c1a8623e96f9dd6155b/bc1ee57b71830e051a7ac1994b6fc709be8ba7e9.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="20"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="f9hppNGF8MjP" data-outputId="5949c45a-f215-4d2b-c93e-97f58ecf761c">
<div class="sourceCode" id="cb5"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>df.shape</span></code></pre></div>
<div class="output execute_result" data-execution_count="20">
<pre><code>(51047, 57)</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="21"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="Qoymr11y1_6s" data-outputId="572e3870-f3e2-4f29-8901-3a7d5f3edcda">
<div class="sourceCode" id="cb7"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.columns)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Index([&#39;Churn&#39;, &#39;MonthlyRevenue&#39;, &#39;MonthlyMinutes&#39;, &#39;TotalRecurringCharge&#39;,
       &#39;DirectorAssistedCalls&#39;, &#39;OverageMinutes&#39;, &#39;RoamingCalls&#39;,
       &#39;PercChangeMinutes&#39;, &#39;PercChangeRevenues&#39;, &#39;DroppedCalls&#39;,
       &#39;BlockedCalls&#39;, &#39;UnansweredCalls&#39;, &#39;CustomerCareCalls&#39;, &#39;ThreewayCalls&#39;,
       &#39;ReceivedCalls&#39;, &#39;OutboundCalls&#39;, &#39;InboundCalls&#39;, &#39;PeakCallsInOut&#39;,
       &#39;OffPeakCallsInOut&#39;, &#39;DroppedBlockedCalls&#39;, &#39;CallForwardingCalls&#39;,
       &#39;CallWaitingCalls&#39;, &#39;MonthsInService&#39;, &#39;UniqueSubs&#39;, &#39;ActiveSubs&#39;,
       &#39;ServiceArea&#39;, &#39;Handsets&#39;, &#39;HandsetModels&#39;, &#39;CurrentEquipmentDays&#39;,
       &#39;AgeHH1&#39;, &#39;AgeHH2&#39;, &#39;ChildrenInHH&#39;, &#39;HandsetRefurbished&#39;,
       &#39;HandsetWebCapable&#39;, &#39;TruckOwner&#39;, &#39;RVOwner&#39;, &#39;Homeownership&#39;,
       &#39;BuysViaMailOrder&#39;, &#39;RespondsToMailOffers&#39;, &#39;OptOutMailings&#39;,
       &#39;NonUSTravel&#39;, &#39;OwnsComputer&#39;, &#39;HasCreditCard&#39;, &#39;RetentionCalls&#39;,
       &#39;RetentionOffersAccepted&#39;, &#39;NewCellphoneUser&#39;, &#39;NotNewCellphoneUser&#39;,
       &#39;ReferralsMadeBySubscriber&#39;, &#39;IncomeGroup&#39;, &#39;OwnsMotorcycle&#39;,
       &#39;AdjustmentsToCreditRating&#39;, &#39;HandsetPrice&#39;, &#39;MadeCallToRetentionTeam&#39;,
       &#39;CreditRating&#39;, &#39;PrizmCode&#39;, &#39;Occupation&#39;, &#39;MaritalStatus&#39;],
      dtype=&#39;object&#39;)
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="22"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="Bj_NAOKK0CdF" data-outputId="37ea9696-7a2e-461e-bc57-29a6610e42eb">
<div class="sourceCode" id="cb9"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.dtypes)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Churn                         object
MonthlyRevenue               float64
MonthlyMinutes               float64
TotalRecurringCharge         float64
DirectorAssistedCalls        float64
OverageMinutes               float64
RoamingCalls                 float64
PercChangeMinutes            float64
PercChangeRevenues           float64
DroppedCalls                 float64
BlockedCalls                 float64
UnansweredCalls              float64
CustomerCareCalls            float64
ThreewayCalls                float64
ReceivedCalls                float64
OutboundCalls                float64
InboundCalls                 float64
PeakCallsInOut               float64
OffPeakCallsInOut            float64
DroppedBlockedCalls          float64
CallForwardingCalls          float64
CallWaitingCalls             float64
MonthsInService                int64
UniqueSubs                     int64
ActiveSubs                     int64
ServiceArea                   object
Handsets                     float64
HandsetModels                float64
CurrentEquipmentDays         float64
AgeHH1                       float64
AgeHH2                       float64
ChildrenInHH                  object
HandsetRefurbished            object
HandsetWebCapable             object
TruckOwner                    object
RVOwner                       object
Homeownership                 object
BuysViaMailOrder              object
RespondsToMailOffers          object
OptOutMailings                object
NonUSTravel                   object
OwnsComputer                  object
HasCreditCard                 object
RetentionCalls                 int64
RetentionOffersAccepted        int64
NewCellphoneUser              object
NotNewCellphoneUser           object
ReferralsMadeBySubscriber      int64
IncomeGroup                    int64
OwnsMotorcycle                object
AdjustmentsToCreditRating      int64
HandsetPrice                  object
MadeCallToRetentionTeam       object
CreditRating                  object
PrizmCode                     object
Occupation                    object
MaritalStatus                 object
dtype: object
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="23"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:350}"
id="-4PXFjy38X3J" data-outputId="a32af3ff-b2cc-4bb3-f11a-fa907848f859">
<div class="sourceCode" id="cb11"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>df.describe()</span></code></pre></div>
<div class="output execute_result" data-execution_count="23">

  <div id="df-3693c925-d279-4e9f-ab9a-772fb3e8fe30" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MonthlyRevenue</th>
      <th>MonthlyMinutes</th>
      <th>TotalRecurringCharge</th>
      <th>DirectorAssistedCalls</th>
      <th>OverageMinutes</th>
      <th>RoamingCalls</th>
      <th>PercChangeMinutes</th>
      <th>PercChangeRevenues</th>
      <th>DroppedCalls</th>
      <th>BlockedCalls</th>
      <th>...</th>
      <th>Handsets</th>
      <th>HandsetModels</th>
      <th>CurrentEquipmentDays</th>
      <th>AgeHH1</th>
      <th>AgeHH2</th>
      <th>RetentionCalls</th>
      <th>RetentionOffersAccepted</th>
      <th>ReferralsMadeBySubscriber</th>
      <th>IncomeGroup</th>
      <th>AdjustmentsToCreditRating</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>50891.000000</td>
      <td>50891.000000</td>
      <td>50891.000000</td>
      <td>50891.000000</td>
      <td>50891.000000</td>
      <td>50891.000000</td>
      <td>50680.000000</td>
      <td>50680.000000</td>
      <td>51047.000000</td>
      <td>51047.000000</td>
      <td>...</td>
      <td>51046.000000</td>
      <td>51046.000000</td>
      <td>51046.000000</td>
      <td>50138.000000</td>
      <td>50138.000000</td>
      <td>51047.000000</td>
      <td>51047.000000</td>
      <td>51047.000000</td>
      <td>51047.000000</td>
      <td>51047.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>58.834492</td>
      <td>525.653416</td>
      <td>46.830088</td>
      <td>0.895229</td>
      <td>40.027785</td>
      <td>1.236244</td>
      <td>-11.547908</td>
      <td>-1.191985</td>
      <td>6.011489</td>
      <td>4.085672</td>
      <td>...</td>
      <td>1.805646</td>
      <td>1.558751</td>
      <td>380.545841</td>
      <td>31.338127</td>
      <td>21.144142</td>
      <td>0.037201</td>
      <td>0.018277</td>
      <td>0.052070</td>
      <td>4.324524</td>
      <td>0.053911</td>
    </tr>
    <tr>
      <th>std</th>
      <td>44.507336</td>
      <td>529.871063</td>
      <td>23.848871</td>
      <td>2.228546</td>
      <td>96.588076</td>
      <td>9.818294</td>
      <td>257.514772</td>
      <td>39.574915</td>
      <td>9.043955</td>
      <td>10.946905</td>
      <td>...</td>
      <td>1.331173</td>
      <td>0.905932</td>
      <td>253.801982</td>
      <td>22.094635</td>
      <td>23.931368</td>
      <td>0.206483</td>
      <td>0.142458</td>
      <td>0.307592</td>
      <td>3.138236</td>
      <td>0.383147</td>
    </tr>
    <tr>
      <th>min</th>
      <td>-6.170000</td>
      <td>0.000000</td>
      <td>-11.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>-3875.000000</td>
      <td>-1107.700000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>...</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>-5.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>33.610000</td>
      <td>158.000000</td>
      <td>30.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>-83.000000</td>
      <td>-7.100000</td>
      <td>0.700000</td>
      <td>0.000000</td>
      <td>...</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>205.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>48.460000</td>
      <td>366.000000</td>
      <td>45.000000</td>
      <td>0.250000</td>
      <td>3.000000</td>
      <td>0.000000</td>
      <td>-5.000000</td>
      <td>-0.300000</td>
      <td>3.000000</td>
      <td>1.000000</td>
      <td>...</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>329.000000</td>
      <td>36.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>5.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>71.065000</td>
      <td>723.000000</td>
      <td>60.000000</td>
      <td>0.990000</td>
      <td>41.000000</td>
      <td>0.300000</td>
      <td>66.000000</td>
      <td>1.600000</td>
      <td>7.700000</td>
      <td>3.700000</td>
      <td>...</td>
      <td>2.000000</td>
      <td>2.000000</td>
      <td>515.000000</td>
      <td>48.000000</td>
      <td>42.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>7.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>1223.380000</td>
      <td>7359.000000</td>
      <td>400.000000</td>
      <td>159.390000</td>
      <td>4321.000000</td>
      <td>1112.400000</td>
      <td>5192.000000</td>
      <td>2483.500000</td>
      <td>221.700000</td>
      <td>384.300000</td>
      <td>...</td>
      <td>24.000000</td>
      <td>15.000000</td>
      <td>1812.000000</td>
      <td>99.000000</td>
      <td>99.000000</td>
      <td>4.000000</td>
      <td>3.000000</td>
      <td>35.000000</td>
      <td>9.000000</td>
      <td>25.000000</td>
    </tr>
  </tbody>
</table>
<p>8 rows × 34 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-3693c925-d279-4e9f-ab9a-772fb3e8fe30')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-3693c925-d279-4e9f-ab9a-772fb3e8fe30 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-3693c925-d279-4e9f-ab9a-772fb3e8fe30');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-a15c7780-6d69-4bd7-ac1b-f7924e0de642">
  <button class="colab-df-quickchart" onclick="quickchart('df-a15c7780-6d69-4bd7-ac1b-f7924e0de642')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-a15c7780-6d69-4bd7-ac1b-f7924e0de642 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="27" id="PHEKMgUvCQl-">
<div class="sourceCode" id="cb12"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>df.drop(<span class="st">&#39;CustomerID&#39;</span>, axis<span class="op">=</span><span class="dv">1</span>,inplace <span class="op">=</span> <span class="va">True</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="28"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:523}"
id="JykLOp7k6rm7" data-outputId="f7a3bb27-9b6a-4e3a-be04-fe0062028151">
<div class="sourceCode" id="cb13"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>null_values <span class="op">=</span> df.isnull().<span class="bu">sum</span>()</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>null_values[null_values <span class="op">&gt;</span> <span class="dv">0</span>]</span></code></pre></div>
<div class="output execute_result" data-execution_count="28">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>MonthlyRevenue</th>
      <td>156</td>
    </tr>
    <tr>
      <th>MonthlyMinutes</th>
      <td>156</td>
    </tr>
    <tr>
      <th>TotalRecurringCharge</th>
      <td>156</td>
    </tr>
    <tr>
      <th>DirectorAssistedCalls</th>
      <td>156</td>
    </tr>
    <tr>
      <th>OverageMinutes</th>
      <td>156</td>
    </tr>
    <tr>
      <th>RoamingCalls</th>
      <td>156</td>
    </tr>
    <tr>
      <th>PercChangeMinutes</th>
      <td>367</td>
    </tr>
    <tr>
      <th>PercChangeRevenues</th>
      <td>367</td>
    </tr>
    <tr>
      <th>ServiceArea</th>
      <td>24</td>
    </tr>
    <tr>
      <th>Handsets</th>
      <td>1</td>
    </tr>
    <tr>
      <th>HandsetModels</th>
      <td>1</td>
    </tr>
    <tr>
      <th>CurrentEquipmentDays</th>
      <td>1</td>
    </tr>
    <tr>
      <th>AgeHH1</th>
      <td>909</td>
    </tr>
    <tr>
      <th>AgeHH2</th>
      <td>909</td>
    </tr>
  </tbody>
</table>
</div><br><label><b>dtype:</b> int64</label>
</div>
</div>
<div class="cell code" data-execution_count="29"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="zeC1Lda2uhlz" data-outputId="b9b2060f-1985-402e-87bb-4a27cb8b3425">
<div class="sourceCode" id="cb14"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>df.shape</span></code></pre></div>
<div class="output execute_result" data-execution_count="29">
<pre><code>(51047, 57)</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="30"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:178}"
id="M41ucZzCCbI-" data-outputId="07e01b71-8d91-49d6-be27-952bc5684bc1">
<div class="sourceCode" id="cb16"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>df.Homeownership.value_counts()</span></code></pre></div>
<div class="output execute_result" data-execution_count="30">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
    </tr>
    <tr>
      <th>Homeownership</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Known</th>
      <td>33987</td>
    </tr>
    <tr>
      <th>Unknown</th>
      <td>17060</td>
    </tr>
  </tbody>
</table>
</div><br><label><b>dtype:</b> int64</label>
</div>
</div>
<div class="cell code" data-execution_count="31"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="aML5hR5q2nzu" data-outputId="40b56bba-a6f5-4ee4-e6fc-665ac1875bc1">
<div class="sourceCode" id="cb17"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> df.columns:</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;Value counts for column &#39;</span><span class="sc">{</span>col<span class="sc">}</span><span class="ss">&#39;:&quot;</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(df[col].value_counts())</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;-&quot;</span> <span class="op">*</span> <span class="dv">50</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Value counts for column &#39;Churn&#39;:
Churn
No     36336
Yes    14711
Name: count, dtype: int64
--------------------------------------------------
Value counts for column &#39;MonthlyRevenue&#39;:
MonthlyRevenue
29.99     1069
34.99      806
10.00      469
30.00      404
49.99      392
          ... 
118.03       1
230.65       1
194.90       1
119.77       1
109.96       1
Name: count, Length: 12665, dtype: int64
--------------------------------------------------
Value counts for column &#39;MonthlyMinutes&#39;:
MonthlyMinutes
0.0       723
2.0       138
8.0       127
6.0       122
88.0      116
         ... 
2252.0      1
2391.0      1
3129.0      1
4578.0      1
2437.0      1
Name: count, Length: 2719, dtype: int64
--------------------------------------------------
Value counts for column &#39;TotalRecurringCharge&#39;:
TotalRecurringCharge
30.0     7302
45.0     6630
60.0     4435
40.0     4415
50.0     4143
         ... 
149.0       1
302.0       1
281.0       1
207.0       1
212.0       1
Name: count, Length: 214, dtype: int64
--------------------------------------------------
Value counts for column &#39;DirectorAssistedCalls&#39;:
DirectorAssistedCalls
0.00     24512
0.25      6757
0.50      3948
0.74      2748
0.99      1993
         ...  
5.28         1
45.05        1
18.32        1
32.17        1
9.57         1
Name: count, Length: 146, dtype: int64
--------------------------------------------------
Value counts for column &#39;OverageMinutes&#39;:
OverageMinutes
0.0       23262
2.0        1088
1.0        1018
4.0         847
6.0         693
          ...  
741.0         1
604.0         1
412.0         1
409.0         1
2018.0        1
Name: count, Length: 746, dtype: int64
--------------------------------------------------
Value counts for column &#39;RoamingCalls&#39;:
RoamingCalls
0.0      34947
0.2       1744
0.1       1444
0.3       1177
0.5        836
         ...  
48.2         1
92.1         1
330.2        1
52.4         1
55.6         1
Name: count, Length: 530, dtype: int64
--------------------------------------------------
Value counts for column &#39;PercChangeMinutes&#39;:
PercChangeMinutes
 0.0       1124
-2.0        430
-4.0        369
-8.0        346
 2.0        338
           ... 
-1509.0       1
-863.0        1
-1087.0       1
 1358.0       1
 1578.0       1
Name: count, Length: 2262, dtype: int64
--------------------------------------------------
Value counts for column &#39;PercChangeRevenues&#39;:
PercChangeRevenues
 0.0      5818
-0.2      1497
-0.3      1365
-0.5       883
-0.4       697
          ... 
 401.5       1
-134.6       1
 115.3       1
 372.5       1
-253.9       1
Name: count, Length: 2899, dtype: int64
--------------------------------------------------
Value counts for column &#39;DroppedCalls&#39;:
DroppedCalls
0.0      7738
0.7      2615
0.3      2540
1.3      2294
1.0      2290
         ... 
9.5         1
83.3        1
87.3        1
98.7        1
101.7       1
Name: count, Length: 285, dtype: int64
--------------------------------------------------
Value counts for column &#39;BlockedCalls&#39;:
BlockedCalls
0.0      13912
0.3       5254
0.7       4526
1.0       2966
1.3       2633
         ...  
139.0        1
174.3        1
147.7        1
124.0        1
103.7        1
Name: count, Length: 373, dtype: int64
--------------------------------------------------
Value counts for column &#39;UnansweredCalls&#39;:
UnansweredCalls
0.0      4990
0.7       607
1.3       579
0.3       550
2.0       550
         ... 
330.7       1
370.0       1
259.7       1
263.0       1
287.0       1
Name: count, Length: 840, dtype: int64
--------------------------------------------------
Value counts for column &#39;CustomerCareCalls&#39;:
CustomerCareCalls
0.0      28020
0.3       3613
0.7       2736
1.0       1785
1.3       1616
         ...  
93.0         1
273.0        1
75.0         1
52.7         1
132.3        1
Name: count, Length: 185, dtype: int64
--------------------------------------------------
Value counts for column &#39;ThreewayCalls&#39;:
ThreewayCalls
0.0     37133
0.3      6109
0.7      3183
1.0      1388
1.3       896
        ...  
30.3        1
66.0        1
26.0        1
19.3        1
65.3        1
Name: count, Length: 78, dtype: int64
--------------------------------------------------
Value counts for column &#39;ReceivedCalls&#39;:
ReceivedCalls
0.0       6337
0.1        241
0.2        225
0.3        183
0.6        164
          ... 
855.8        1
658.7        1
875.5        1
738.0        1
1225.3       1
Name: count, Length: 6121, dtype: int64
--------------------------------------------------
Value counts for column &#39;OutboundCalls&#39;:
OutboundCalls
0.0      6428
0.3       944
0.7       903
1.3       717
1.0       713
         ... 
277.3       1
325.3       1
313.7       1
232.7       1
430.3       1
Name: count, Length: 787, dtype: int64
--------------------------------------------------
Value counts for column &#39;InboundCalls&#39;:
InboundCalls
0.0      14999
0.3       2883
0.7       2390
1.0       1657
1.3       1557
         ...  
137.3        1
270.0        1
131.7        1
190.0        1
163.7        1
Name: count, Length: 472, dtype: int64
--------------------------------------------------
Value counts for column &#39;PeakCallsInOut&#39;:
PeakCallsInOut
0.0       4224
0.3        194
0.7        164
2.7        159
3.3        143
          ... 
465.0        1
692.0        1
665.7        1
547.0        1
1359.0       1
Name: count, Length: 1839, dtype: int64
--------------------------------------------------
Value counts for column &#39;OffPeakCallsInOut&#39;:
OffPeakCallsInOut
0.0      4547
0.7       333
1.3       305
2.7       298
0.3       291
         ... 
461.0       1
350.3       1
747.3       1
811.7       1
910.3       1
Name: count, Length: 1669, dtype: int64
--------------------------------------------------
Value counts for column &#39;DroppedBlockedCalls&#39;:
DroppedBlockedCalls
0.0      5793
1.3      1506
0.7      1492
2.0      1441
0.3      1379
         ... 
171.0       1
288.3       1
108.7       1
161.0       1
99.0        1
Name: count, Length: 447, dtype: int64
--------------------------------------------------
Value counts for column &#39;CallForwardingCalls&#39;:
CallForwardingCalls
0.0     50813
0.3       101
0.7        50
1.0        18
2.0        13
1.3        11
2.3         8
1.7         5
3.7         3
2.7         2
4.0         2
5.0         2
55.7        1
21.0        1
5.3         1
3.0         1
12.0        1
81.3        1
22.0        1
10.7        1
8.7         1
26.3        1
11.0        1
31.3        1
6.3         1
33.7        1
16.0        1
9.7         1
51.7        1
23.7        1
12.3        1
Name: count, dtype: int64
--------------------------------------------------
Value counts for column &#39;CallWaitingCalls&#39;:
CallWaitingCalls
0.0      25029
0.3       5427
0.7       3759
1.0       2316
1.3       1872
         ...  
63.0         1
80.0         1
64.3         1
105.3        1
86.3         1
Name: count, Length: 223, dtype: int64
--------------------------------------------------
Value counts for column &#39;MonthsInService&#39;:
MonthsInService
11    3599
7     2821
12    2737
13    2719
9     2477
10    2381
14    2291
8     2214
19    2004
15    1871
23    1836
21    1809
16    1778
17    1749
25    1611
18    1509
20    1413
22    1269
24    1174
26    1022
27     935
29     899
31     863
6      746
28     741
33     717
30     700
35     685
32     589
34     543
37     466
36     425
38     286
39     240
41     210
40     175
43     174
42     151
45     144
44     140
47     124
48     117
49     111
46     110
53      90
50      84
51      64
52      57
54      50
55      43
57      25
56      20
59      20
58      11
60       7
61       1
Name: count, dtype: int64
--------------------------------------------------
Value counts for column &#39;UniqueSubs&#39;:
UniqueSubs
1      32109
2      13852
3       3212
4       1219
5        421
6        147
7         49
9         12
8         10
10         6
12         3
11         3
13         2
18         1
196        1
Name: count, dtype: int64
--------------------------------------------------
Value counts for column &#39;ActiveSubs&#39;:
ActiveSubs
1     36267
2     12223
3      1907
4       444
5       144
0        39
6        13
8         5
7         2
9         1
53        1
11        1
Name: count, dtype: int64
--------------------------------------------------
Value counts for column &#39;ServiceArea&#39;:
ServiceArea
NYCBRO917    1684
HOUHOU281    1510
DALDAL214    1498
NYCMAN917    1182
APCFCH703     783
             ... 
OHIRAV330       1
OMANEW515       1
KCYHES316       1
AIRGEO843       1
NCRDNN910       1
Name: count, Length: 747, dtype: int64
--------------------------------------------------
Value counts for column &#39;Handsets&#39;:
Handsets
1.0     28852
2.0     12708
3.0      5072
4.0      2232
5.0      1033
6.0       487
7.0       297
8.0       147
9.0        82
10.0       38
11.0       35
12.0       19
13.0       16
14.0        7
16.0        5
15.0        3
19.0        3
17.0        3
24.0        2
18.0        2
21.0        1
22.0        1
20.0        1
Name: count, dtype: int64
--------------------------------------------------
Value counts for column &#39;HandsetModels&#39;:
HandsetModels
1.0     31881
2.0     13028
3.0      4129
4.0      1278
5.0       449
6.0       173
7.0        59
8.0        24
9.0        16
10.0        6
11.0        1
15.0        1
14.0        1
Name: count, dtype: int64
--------------------------------------------------
Value counts for column &#39;CurrentEquipmentDays&#39;:
CurrentEquipmentDays
202.0     159
313.0     156
212.0     149
199.0     147
308.0     147
         ... 
1438.0      1
1381.0      1
1443.0      1
1276.0      1
1219.0      1
Name: count, Length: 1438, dtype: int64
--------------------------------------------------
Value counts for column &#39;AgeHH1&#39;:
AgeHH1
0.0     13917
46.0     2149
42.0     2074
50.0     2063
48.0     2055
44.0     2037
40.0     1979
52.0     1968
38.0     1967
36.0     1889
30.0     1875
32.0     1826
34.0     1823
54.0     1719
28.0     1657
26.0     1392
56.0     1382
58.0     1237
24.0      859
60.0      811
22.0      543
62.0      476
64.0      402
66.0      308
68.0      281
20.0      261
70.0      248
72.0      227
74.0      167
76.0      137
78.0      102
80.0       81
82.0       57
18.0       44
84.0       44
86.0       29
88.0       23
90.0       12
94.0        7
92.0        6
98.0        2
99.0        1
96.0        1
Name: count, dtype: int64
--------------------------------------------------
Value counts for column &#39;AgeHH2&#39;:
AgeHH2
0.0     26087
46.0     1487
48.0     1419
44.0     1411
50.0     1335
42.0     1330
52.0     1295
40.0     1292
38.0     1218
36.0     1193
34.0     1131
32.0     1120
30.0     1081
54.0     1075
28.0      896
56.0      737
26.0      729
24.0      655
58.0      590
60.0      525
62.0      447
22.0      445
64.0      366
20.0      351
66.0      313
68.0      269
70.0      227
72.0      188
18.0      179
74.0      169
76.0      127
78.0      119
80.0      107
82.0       58
86.0       37
84.0       34
90.0       29
88.0       27
96.0       11
98.0       10
94.0       10
92.0        8
99.0        1
Name: count, dtype: int64
--------------------------------------------------
Value counts for column &#39;ChildrenInHH&#39;:
ChildrenInHH
No     38679
Yes    12368
Name: count, dtype: int64
--------------------------------------------------
Value counts for column &#39;HandsetRefurbished&#39;:
HandsetRefurbished
No     43956
Yes     7091
Name: count, dtype: int64
--------------------------------------------------
Value counts for column &#39;HandsetWebCapable&#39;:
HandsetWebCapable
Yes    46046
No      5001
Name: count, dtype: int64
--------------------------------------------------
Value counts for column &#39;TruckOwner&#39;:
TruckOwner
No     41524
Yes     9523
Name: count, dtype: int64
--------------------------------------------------
Value counts for column &#39;RVOwner&#39;:
RVOwner
No     46894
Yes     4153
Name: count, dtype: int64
--------------------------------------------------
Value counts for column &#39;Homeownership&#39;:
Homeownership
Known      33987
Unknown    17060
Name: count, dtype: int64
--------------------------------------------------
Value counts for column &#39;BuysViaMailOrder&#39;:
BuysViaMailOrder
No     32596
Yes    18451
Name: count, dtype: int64
--------------------------------------------------
Value counts for column &#39;RespondsToMailOffers&#39;:
RespondsToMailOffers
No     31821
Yes    19226
Name: count, dtype: int64
--------------------------------------------------
Value counts for column &#39;OptOutMailings&#39;:
OptOutMailings
No     50295
Yes      752
Name: count, dtype: int64
--------------------------------------------------
Value counts for column &#39;NonUSTravel&#39;:
NonUSTravel
No     48168
Yes     2879
Name: count, dtype: int64
--------------------------------------------------
Value counts for column &#39;OwnsComputer&#39;:
OwnsComputer
No     41583
Yes     9464
Name: count, dtype: int64
--------------------------------------------------
Value counts for column &#39;HasCreditCard&#39;:
HasCreditCard
Yes    34503
No     16544
Name: count, dtype: int64
--------------------------------------------------
Value counts for column &#39;RetentionCalls&#39;:
RetentionCalls
0    49302
1     1609
2      120
3       14
4        2
Name: count, dtype: int64
--------------------------------------------------
Value counts for column &#39;RetentionOffersAccepted&#39;:
RetentionOffersAccepted
0    50166
1      837
2       36
3        8
Name: count, dtype: int64
--------------------------------------------------
Value counts for column &#39;NewCellphoneUser&#39;:
NewCellphoneUser
No     41223
Yes     9824
Name: count, dtype: int64
--------------------------------------------------
Value counts for column &#39;NotNewCellphoneUser&#39;:
NotNewCellphoneUser
No     44012
Yes     7035
Name: count, dtype: int64
--------------------------------------------------
Value counts for column &#39;ReferralsMadeBySubscriber&#39;:
ReferralsMadeBySubscriber
0     48663
1      2244
2       100
3        21
4         6
6         4
7         2
5         2
16        1
11        1
8         1
9         1
35        1
Name: count, dtype: int64
--------------------------------------------------
Value counts for column &#39;IncomeGroup&#39;:
IncomeGroup
0    12835
6     9607
7     5877
9     5563
5     4262
4     4053
3     2991
8     2622
1     2039
2     1198
Name: count, dtype: int64
--------------------------------------------------
Value counts for column &#39;OwnsMotorcycle&#39;:
OwnsMotorcycle
No     50368
Yes      679
Name: count, dtype: int64
--------------------------------------------------
Value counts for column &#39;AdjustmentsToCreditRating&#39;:
AdjustmentsToCreditRating
0     49209
1      1401
2       248
3        92
4        34
5        30
6         8
8         7
7         6
9         4
11        3
10        2
25        1
21        1
12        1
Name: count, dtype: int64
--------------------------------------------------
Value counts for column &#39;HandsetPrice&#39;:
HandsetPrice
Unknown    28982
30          7328
150         4115
130         2105
80          1960
10          1928
60          1776
200         1266
100         1235
40           249
400           46
250           20
300           13
180           10
500            8
240            6
Name: count, dtype: int64
--------------------------------------------------
Value counts for column &#39;MadeCallToRetentionTeam&#39;:
MadeCallToRetentionTeam
No     49302
Yes     1745
Name: count, dtype: int64
--------------------------------------------------
Value counts for column &#39;CreditRating&#39;:
CreditRating
2-High       18993
1-Highest     8522
3-Good        8410
5-Low         6499
4-Medium      5357
7-Lowest      2114
6-VeryLow     1152
Name: count, dtype: int64
--------------------------------------------------
Value counts for column &#39;PrizmCode&#39;:
PrizmCode
Other       24655
Suburban    16378
Town         7589
Rural        2425
Name: count, dtype: int64
--------------------------------------------------
Value counts for column &#39;Occupation&#39;:
Occupation
Other           37637
Professional     8755
Crafts           1519
Clerical          986
Self              879
Retired           733
Student           381
Homemaker         157
Name: count, dtype: int64
--------------------------------------------------
Value counts for column &#39;MaritalStatus&#39;:
MaritalStatus
Unknown    19700
Yes        18651
No         12696
Name: count, dtype: int64
--------------------------------------------------
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="32"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:617}"
id="u3jVhgrOvwO5" data-outputId="0d8addfd-1981-4629-f8f3-e4b2f09bdeb3">
<div class="sourceCode" id="cb19"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>df.HandsetPrice.value_counts()</span></code></pre></div>
<div class="output execute_result" data-execution_count="32">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
    </tr>
    <tr>
      <th>HandsetPrice</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Unknown</th>
      <td>28982</td>
    </tr>
    <tr>
      <th>30</th>
      <td>7328</td>
    </tr>
    <tr>
      <th>150</th>
      <td>4115</td>
    </tr>
    <tr>
      <th>130</th>
      <td>2105</td>
    </tr>
    <tr>
      <th>80</th>
      <td>1960</td>
    </tr>
    <tr>
      <th>10</th>
      <td>1928</td>
    </tr>
    <tr>
      <th>60</th>
      <td>1776</td>
    </tr>
    <tr>
      <th>200</th>
      <td>1266</td>
    </tr>
    <tr>
      <th>100</th>
      <td>1235</td>
    </tr>
    <tr>
      <th>40</th>
      <td>249</td>
    </tr>
    <tr>
      <th>400</th>
      <td>46</td>
    </tr>
    <tr>
      <th>250</th>
      <td>20</td>
    </tr>
    <tr>
      <th>300</th>
      <td>13</td>
    </tr>
    <tr>
      <th>180</th>
      <td>10</td>
    </tr>
    <tr>
      <th>500</th>
      <td>8</td>
    </tr>
    <tr>
      <th>240</th>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div><br><label><b>dtype:</b> int64</label>
</div>
</div>
<div class="cell code" data-execution_count="33"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="qxnolimhs_UT" data-outputId="337a4b0c-da74-4f9f-d5fc-34990356d3f3">
<div class="sourceCode" id="cb20"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>df.HandsetPrice.unique()</span></code></pre></div>
<div class="output execute_result" data-execution_count="33">
<pre><code>array([&#39;30&#39;, &#39;Unknown&#39;, &#39;10&#39;, &#39;80&#39;, &#39;150&#39;, &#39;300&#39;, &#39;40&#39;, &#39;200&#39;, &#39;100&#39;,
       &#39;130&#39;, &#39;60&#39;, &#39;400&#39;, &#39;240&#39;, &#39;250&#39;, &#39;180&#39;, &#39;500&#39;], dtype=object)</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="50"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="2AMsgEHz5aaF" data-outputId="027bb430-fa8c-4247-a988-50066fb953c2">
<div class="sourceCode" id="cb22"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;HandsetPrice&#39;</span>] <span class="op">=</span> pd.to_numeric(df[<span class="st">&#39;HandsetPrice&#39;</span>], errors<span class="op">=</span><span class="st">&#39;coerce&#39;</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>known <span class="op">=</span> df.dropna(subset<span class="op">=</span>[<span class="st">&#39;HandsetPrice&#39;</span>])</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>unknown <span class="op">=</span> df[df[<span class="st">&#39;HandsetPrice&#39;</span>].isna()]</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>X_train <span class="op">=</span> known.select_dtypes(include<span class="op">=</span><span class="st">&#39;number&#39;</span>).drop(<span class="st">&#39;HandsetPrice&#39;</span>, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>y_train <span class="op">=</span> known[<span class="st">&#39;HandsetPrice&#39;</span>]</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>X_test <span class="op">=</span> unknown.select_dtypes(include<span class="op">=</span><span class="st">&#39;number&#39;</span>).drop(<span class="st">&#39;HandsetPrice&#39;</span>, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="kw">not</span> X_test.empty:</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> RandomForestRegressor(n_estimators<span class="op">=</span><span class="dv">100</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    model.fit(X_train, y_train)</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>    df.loc[df[<span class="st">&#39;HandsetPrice&#39;</span>].isna(), <span class="st">&#39;HandsetPrice&#39;</span>] <span class="op">=</span> model.predict(X_test)</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;Missing &#39;Unknown&#39; values replaced successfully.&quot;</span>)</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;No missing values to replace.&quot;</span>)</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df[<span class="st">&#39;HandsetPrice&#39;</span>].value_counts())</span></code></pre></div>
<div class="output stream stdout">
<pre><code>No missing values to replace.
HandsetPrice
30.0     7450
150.0    4127
130.0    2149
80.0     1978
10.0     1928
         ... 
182.8       1
204.2       1
158.8       1
176.9       1
26.2        1
Name: count, Length: 1453, dtype: int64
</code></pre>
</div>
</div>
<div class="cell markdown" id="SoIrk_jy7AKd">
<p>By using Random forest fills missing handset prices by replacing
'Unknown' values with NaN. It splits the data into two parts: one with
known prices to train a Random Forest Regressor and another with unknown
prices to predict. The model learns patterns from the known prices and
related features, such as customer data and usage. It then predicts the
missing values for the rows with unknown prices. These predictions
replace the NaN entries, completing the dataset with estimated handset
prices based on the identified patterns.</p>
</div>
<div class="cell code" data-execution_count="42"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:490}"
id="9oU_vUFb-MVL" data-outputId="77abb030-0d72-4916-d439-d051c62318c6">
<div class="sourceCode" id="cb24"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>df.HandsetPrice.value_counts()</span></code></pre></div>
<div class="output execute_result" data-execution_count="42">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
    </tr>
    <tr>
      <th>HandsetPrice</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>30.0</th>
      <td>7450</td>
    </tr>
    <tr>
      <th>150.0</th>
      <td>4127</td>
    </tr>
    <tr>
      <th>130.0</th>
      <td>2149</td>
    </tr>
    <tr>
      <th>80.0</th>
      <td>1978</td>
    </tr>
    <tr>
      <th>10.0</th>
      <td>1928</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th>182.8</th>
      <td>1</td>
    </tr>
    <tr>
      <th>204.2</th>
      <td>1</td>
    </tr>
    <tr>
      <th>158.8</th>
      <td>1</td>
    </tr>
    <tr>
      <th>176.9</th>
      <td>1</td>
    </tr>
    <tr>
      <th>26.2</th>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>1453 rows × 1 columns</p>
</div><br><label><b>dtype:</b> int64</label>
</div>
</div>
<div class="cell code" data-execution_count="43"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="IweiC-gQ-gPa" data-outputId="840ae983-70f9-490e-96ae-c16b5ddc9eec">
<div class="sourceCode" id="cb25"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>df.HandsetPrice.unique()</span></code></pre></div>
<div class="output execute_result" data-execution_count="43">
<pre><code>array([ 30. ,  28.8,  10. , ..., 168.3, 160.9,  26.2])</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="44"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:472}"
id="X6v2ejwpudHU" data-outputId="c6360f8a-b425-48ca-cc5e-81d9a49ab95a">
<div class="sourceCode" id="cb27"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;HandsetPrice&#39;</span>].plot(kind<span class="op">=</span><span class="st">&#39;hist&#39;</span>, bins<span class="op">=</span><span class="dv">30</span>, edgecolor<span class="op">=</span><span class="st">&#39;black&#39;</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Histogram of Handset Price&#39;</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Handset Price&#39;</span>)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_5cdade6e6d334c1a8623e96f9dd6155b/d7342f0dea6799220e27ee4b5ff789d98f3da51f.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="45"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:472}"
id="jpQG7l-uWnDc" data-outputId="35afa40e-5e26-464d-8972-72cd54a472fb">
<div class="sourceCode" id="cb28"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>sns.countplot(x<span class="op">=</span><span class="st">&#39;Churn&#39;</span>, data<span class="op">=</span>df)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Churn Distribution&#39;</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Churn (0 = No, 1 = Yes)&#39;</span>)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Count&#39;</span>)</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_5cdade6e6d334c1a8623e96f9dd6155b/de74e52978560c7c86c399f94e9e762ed46fcd32.png" /></p>
</div>
</div>
<div class="cell markdown" id="sYgYY3Mggten">
<p>This bar chart represents the distribution of customer churn in the
dataset. The two bars show the counts of customers who have churned
("Yes") and those who have not churned ("No"). o The chart indicates
that a significantly larger number of customers did not churn compared
to those who did. This imbalance in the data suggests that most
customers stayed with the company, while a smaller portion left.
Recognizing this imbalance is important, as it may affect model
performance and necessitate handling methods like resampling to improve
churn prediction.</p>
</div>
<div class="cell code" data-execution_count="46"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:472}"
id="zWmgx0XhXHXt" data-outputId="a5cff817-60bd-4773-9af9-b42a7e2641df">
<div class="sourceCode" id="cb29"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>sns.boxplot(x<span class="op">=</span><span class="st">&#39;Churn&#39;</span>, y<span class="op">=</span><span class="st">&#39;MonthlyRevenue&#39;</span>, data<span class="op">=</span>df)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Monthly Revenue by Churn Status&#39;</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Churn (0 = No, 1 = Yes)&#39;</span>)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Monthly Revenue&#39;</span>)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_5cdade6e6d334c1a8623e96f9dd6155b/3e0dfd970f110c7cc4864c7b69284a3c31e5fa6d.png" /></p>
</div>
</div>
<div class="cell markdown" id="z7SWpLwKgyuH">
<p>This boxplot displays the monthly revenue distribution for customers
who churned ("Yes") and those who did not ("No"). Both groups have a
similar revenue distribution with many outliers, indicating that high
monthly revenue doesn't necessarily correlate with churn.</p>
</div>
<div class="cell code" data-execution_count="47"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:472}"
id="0IOUKSjjXRQ8" data-outputId="ed3324d8-8983-45cc-9b62-d51eb258b276">
<div class="sourceCode" id="cb30"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>sns.boxplot(x<span class="op">=</span><span class="st">&#39;Churn&#39;</span>, y<span class="op">=</span><span class="st">&#39;MonthlyMinutes&#39;</span>, data<span class="op">=</span>df)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Monthly Minutes by Churn Status&#39;</span>)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Churn (0 = No, 1 = Yes)&#39;</span>)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Monthly Minutes&#39;</span>)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_5cdade6e6d334c1a8623e96f9dd6155b/ab38335d19daa56f98b19468c10c3757f3bbd845.png" /></p>
</div>
</div>
<div class="cell markdown" id="JBAHPigDg3Fz">
<p>This boxplot illustrates the distribution of monthly minutes used by
customers based on their churn status. Both churned Yes and non-churned
No customers show similar usage patterns with a significant number of
high-value outliers. This indicates that higher monthly minutes are
present in both groups and do not distinctly correlate with churn.</p>
</div>
<div class="cell code" data-execution_count="48"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:472}"
id="KAaB-l4rXWEz" data-outputId="77c9b11d-5519-4fc3-e1f8-0f5c62d78e3c">
<div class="sourceCode" id="cb31"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>sns.lineplot(x<span class="op">=</span><span class="st">&#39;MonthsInService&#39;</span>, y<span class="op">=</span><span class="st">&#39;MonthlyRevenue&#39;</span>, hue<span class="op">=</span><span class="st">&#39;Churn&#39;</span>, data<span class="op">=</span>df)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Average Revenue by Months in Service&#39;</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Months in Service&#39;</span>)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Monthly Revenue&#39;</span>)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_5cdade6e6d334c1a8623e96f9dd6155b/a3e547d286bd409e0e2fa50e44b6984e40f1d8da.png" /></p>
</div>
</div>
<div class="cell markdown" id="OMhQnQRng7Va">
<p>This line plot shows the trend of average monthly revenue over
different months in service for both churned and non- churned customers.
While both groups start with similar revenue patterns, around the
40–50-month mark, churned customers (blue line) display slightly higher
fluctuations in revenue compared to non-churned customers (orange line).
This could indicate revenue instability among long-term customers who
are at risk of churning.</p>
</div>
<div class="cell code" data-execution_count="49"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:787}"
id="4DIbsKMhXb87" data-outputId="f5cdfa27-2f87-40b1-80b2-772a804aa286">
<div class="sourceCode" id="cb32"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>sns.pairplot(df, <span class="bu">vars</span><span class="op">=</span>[<span class="st">&#39;MonthlyRevenue&#39;</span>, <span class="st">&#39;MonthlyMinutes&#39;</span>, <span class="st">&#39;TotalRecurringCharge&#39;</span>], hue<span class="op">=</span><span class="st">&#39;Churn&#39;</span>, diag_kind<span class="op">=</span><span class="st">&#39;kde&#39;</span>)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>plt.suptitle(<span class="st">&#39;Pair Plot of Key Features by Churn&#39;</span>, y<span class="op">=</span><span class="fl">1.02</span>)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_5cdade6e6d334c1a8623e96f9dd6155b/8d3171f3a802e72d2c9db0bafeef4cfec03d3f8a.png" /></p>
</div>
</div>
<div class="cell markdown" id="8GHaZXGkg_YX">
<ol>
<li>Monthly Revenue vs. Monthly Minutes: This plot shows a positive
correlation between Monthly Revenue and Monthly Minutes, meaning that as
customers use more minutes, their revenue tends to increase. Both
churned and non-churned customers follow a similar trend, though churned
customers seem to have slightly higher usage in some cases.</li>
<li>Monthly Revenue vs. Total Recurring Charge: Monthly Revenue and
Total Recurring Charge also display a positive relationship, as
expected. Customers with higher recurring charges tend to have higher
monthly revenue. The distinction between churned and non-churned
customers isn’t very strong, indicating these features alone might not
be definitive predictors of churn.</li>
<li>Monthly Minutes vs. Total Recurring Charge: This plot also shows a
positive relationship, as customers who spend more time on calls tend to
have higher recurring charges. Churned and non-churned customers are
again mixed within this trend, suggesting no clear separation based on
these two variables alone.</li>
<li>Distributions along the diagonal: The histograms and density plots
along the diagonal show the individual distributions of each feature for
churned and non-churned customers. The churned and non-churned groups
have similar distribution shapes, though churned customers show slightly
higher values in Monthly Revenue and Total Recurring Charge.</li>
</ol>
</div>
<div class="cell code" data-execution_count="66" id="vkUbv45lYTns">
<div class="sourceCode" id="cb33"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>categorical_cols <span class="op">=</span> df.select_dtypes(include<span class="op">=</span>[<span class="st">&#39;object&#39;</span>]).columns</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>label_encoders <span class="op">=</span> {}</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> categorical_cols:</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>    le <span class="op">=</span> LabelEncoder()</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>    df[col] <span class="op">=</span> le.fit_transform(df[col].astype(<span class="bu">str</span>))</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>    label_encoders[col] <span class="op">=</span> le</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>one_hot_encoded_df <span class="op">=</span> pd.get_dummies(df, columns<span class="op">=</span>categorical_cols)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="67"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="_10FOX4oYOkh" data-outputId="c8774889-a711-4461-af95-f382d23a72ae">
<div class="sourceCode" id="cb34"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>correlation <span class="op">=</span> df.corr()[<span class="st">&#39;Churn&#39;</span>].<span class="bu">abs</span>().sort_values(ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>top_features <span class="op">=</span> correlation[<span class="dv">1</span>:<span class="dv">6</span>].index</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Top Features Related to Churn:</span><span class="ch">\n</span><span class="st">&quot;</span>, top_features)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Top Features Related to Churn:
 Index([&#39;CurrentEquipmentDays&#39;, &#39;MadeCallToRetentionTeam&#39;, &#39;RetentionCalls&#39;,
       &#39;HandsetWebCapable&#39;, &#39;TotalRecurringCharge&#39;],
      dtype=&#39;object&#39;)
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="68"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:472}"
id="N0P9e46nYeQX" data-outputId="121da1ac-15a2-4fe0-f5ad-f5d46f9d5c66">
<div class="sourceCode" id="cb36"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>sns.boxplot(x<span class="op">=</span><span class="st">&#39;Churn&#39;</span>, y<span class="op">=</span><span class="st">&#39;MonthlyRevenue&#39;</span>, data<span class="op">=</span>df)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Monthly Revenue by Churn Status&#39;</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Churn (0 = No, 1 = Yes)&#39;</span>)</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Monthly Revenue&#39;</span>)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_5cdade6e6d334c1a8623e96f9dd6155b/c544b205e29e295f015a0b3a69748ffffe9815db.png" /></p>
</div>
</div>
<div class="cell markdown" id="dFT9DyRihE0C">
<p>This box plot shows Monthly Revenue for churned (1) and non-churned
(0) customers. Both groups have similar revenue distributions, with most
values low and a few high-revenue outliers. There’s a slight increase in
median revenue for churned customers, but revenue alone doesn’t clearly
separate churners from non-churners.</p>
</div>
<div class="cell code" data-execution_count="69"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:472}"
id="Jr7gNGIMYin_" data-outputId="41cbaeae-cd49-403b-d11c-8de8322494ac">
<div class="sourceCode" id="cb37"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>sns.boxplot(x<span class="op">=</span><span class="st">&#39;Churn&#39;</span>, y<span class="op">=</span><span class="st">&#39;MonthlyMinutes&#39;</span>, data<span class="op">=</span>df)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Monthly Minutes by Churn Status&#39;</span>)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Churn (0 = No, 1 = Yes)&#39;</span>)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Monthly Minutes&#39;</span>)</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_5cdade6e6d334c1a8623e96f9dd6155b/c14ede818fffbb54756bb8f46881805f09704cf7.png" /></p>
</div>
</div>
<div class="cell markdown" id="I6Jf0z-hhIlL">
<p>This box plot displays Monthly Minutes for customers who churned (1)
and those who didn't (0). Both groups have similar distributions, with a
large concentration of minutes in the lower range and a few outliers
with very high usage. There is no strong indication that higher or lower
monthly minutes significantly differ between churned and non-churned
groups, suggesting this feature alone might not be a strong predictor of
churn.</p>
</div>
<div class="cell code" data-execution_count="70"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:564}"
id="VJU2ADikYmDh" data-outputId="c6545943-3192-4514-e4c8-038fccf47e69">
<div class="sourceCode" id="cb38"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(x<span class="op">=</span><span class="st">&#39;TotalRecurringCharge&#39;</span>, y<span class="op">=</span><span class="st">&#39;MonthlyRevenue&#39;</span>, hue<span class="op">=</span><span class="st">&#39;Churn&#39;</span>, data<span class="op">=</span>df)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Total Recurring Charge vs. Monthly Revenue by Churn Status&#39;</span>)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Total Recurring Charge&#39;</span>)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Monthly Revenue&#39;</span>)</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>plt.legend(title<span class="op">=</span><span class="st">&#39;Churn&#39;</span>)</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_5cdade6e6d334c1a8623e96f9dd6155b/988e7ac6e23cdd6db3f00e532c6d7b696227e9cd.png" /></p>
</div>
</div>
<div class="cell markdown" id="7IbLW5qwhMRc">
<p>This scatter plot illustrates the relationship between Total
Recurring Charge and Monthly Revenue, with churn status indicated by
color (blue for retained, orange for churned customers). There’s a clear
positive correlation: higher Total Recurring Charges generally lead to
higher Monthly Revenue. However, both churned and retained customers are
spread across various revenue levels. This suggests that high spending
doesn’t necessarily prevent churn, as even high-revenue customers
sometimes leave. Therefore, additional factors beyond revenue and
recurring charges might be influencing churn, indicating the need for a
deeper investigation into other behavioral or service-related
variables.</p>
</div>
<div class="cell code" data-execution_count="71"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:561}"
id="QyYFt3s6Yq0Y" data-outputId="ae66b592-6be9-4bac-eda6-ebdada5620b4">
<div class="sourceCode" id="cb39"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>sns.lineplot(x<span class="op">=</span><span class="st">&#39;MonthsInService&#39;</span>, y<span class="op">=</span><span class="st">&#39;MonthlyRevenue&#39;</span>, hue<span class="op">=</span><span class="st">&#39;Churn&#39;</span>, data<span class="op">=</span>df, ci<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Average Revenue by Months in Service&#39;</span>)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Months in Service&#39;</span>)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Monthly Revenue&#39;</span>)</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output stream stderr">
<pre><code>&lt;ipython-input-71-2ce567c73534&gt;:1: FutureWarning: 

The `ci` parameter is deprecated. Use `errorbar=None` for the same effect.

  sns.lineplot(x=&#39;MonthsInService&#39;, y=&#39;MonthlyRevenue&#39;, hue=&#39;Churn&#39;, data=df, ci=None)
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_5cdade6e6d334c1a8623e96f9dd6155b/e5f2ae0d99b66802a2791f1088c2726d4efdfb6a.png" /></p>
</div>
</div>
<div class="cell markdown" id="czxP5ApbhvBx">
<p>The plot shows average monthly revenue by months in service for
churned and non-churned customers. Early on, both groups have similar
revenue, but after about 20 months, churned customers' revenue begins to
decline slightly, hinting at disengagement. In later months, churned
customers display sharp revenue fluctuations, while non-churned
customers maintain steadier revenue. This suggests that drops or erratic
revenue patterns over time could signal a higher risk of churn,
highlighting potential areas for targeted retention efforts.</p>
</div>
<div class="cell code" data-execution_count="72"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:472}"
id="LYHnXdiWYyQr" data-outputId="51073216-1008-4200-864a-033c6279be8f">
<div class="sourceCode" id="cb41"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>sns.countplot(x<span class="op">=</span><span class="st">&#39;UniqueSubs&#39;</span>, hue<span class="op">=</span><span class="st">&#39;Churn&#39;</span>, data<span class="op">=</span>df)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Distribution of Unique Subscribers by Churn Status&#39;</span>)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Unique Subscribers&#39;</span>)</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Count&#39;</span>)</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>plt.legend(title<span class="op">=</span><span class="st">&#39;Churn&#39;</span>)</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_5cdade6e6d334c1a8623e96f9dd6155b/14360f95299f3200f42da6bcfacf4f4d32130348.png" /></p>
</div>
</div>
<div class="cell markdown" id="IpA8Cv_diKKE">
<p>This plot shows the distribution of the number of unique subscribers
by churn status. The majority of both churned and non-churned customers
have only one subscriber on their account, with significantly more
non-churned accounts in this category. As the number of unique
subscribers increases, the count for both churned and non-churned
customers decreases sharply, indicating that accounts with multiple
unique subscribers are less common. The pattern suggests that customers
with more subscribers may have a lower likelihood of churning, but the
correlation isn’t strong due to the low counts in higher subscriber
categories.</p>
</div>
<div class="cell markdown" id="5JAEZWHtZAhX">
<p>segmentation</p>
</div>
<div class="cell code" data-execution_count="58" id="5b1hvaayZJXD">
<div class="sourceCode" id="cb42"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.dropna</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="73" id="I43XjZsAZClY">
<div class="sourceCode" id="cb43"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>features <span class="op">=</span> df[[<span class="st">&#39;MonthlyRevenue&#39;</span>, <span class="st">&#39;MonthlyMinutes&#39;</span>, <span class="st">&#39;TotalRecurringCharge&#39;</span>,</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>               <span class="st">&#39;MonthsInService&#39;</span>, <span class="st">&#39;UniqueSubs&#39;</span>, <span class="st">&#39;Handsets&#39;</span>]]</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> StandardScaler()</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>scaled_features <span class="op">=</span> scaler.fit_transform(features)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="74"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:472}"
id="2m-bTbmwZFua" data-outputId="7c1f17a7-b562-48b8-f2e1-0a7e371c08b7">
<div class="sourceCode" id="cb44"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>scaled_features <span class="op">=</span> scaled_features[<span class="op">~</span>np.isnan(scaled_features).<span class="bu">any</span>(axis<span class="op">=</span><span class="dv">1</span>)]</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>scaled_features_df <span class="op">=</span> pd.DataFrame(scaled_features, columns<span class="op">=</span>features.columns)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>kmeans <span class="op">=</span> KMeans(n_clusters<span class="op">=</span><span class="dv">3</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>kmeans.fit(scaled_features)</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> kmeans.labels_</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>scaled_features_df <span class="op">=</span> pd.DataFrame(scaled_features, columns<span class="op">=</span>features.columns)</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>inertia <span class="op">=</span> []</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">11</span>):</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>    kmeans <span class="op">=</span> KMeans(n_clusters<span class="op">=</span>k, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>    kmeans.fit(scaled_features)</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>    inertia.append(kmeans.inertia_)</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>plt.plot(<span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">11</span>), inertia, marker<span class="op">=</span><span class="st">&#39;o&#39;</span>)</span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Elbow Method for Optimal k&#39;</span>)</span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Number of Clusters&#39;</span>)</span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Inertia&#39;</span>)</span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_5cdade6e6d334c1a8623e96f9dd6155b/57da5686cab7f38424964ceaa7420c0acf83bcae.png" /></p>
</div>
</div>
<div class="cell markdown" id="FbpTFMhJirSm">
<p>This Elbow Method plot shows the relationship between the number of
clusters (k) and the inertia (within-cluster sum of squares). The
"elbow" point, where the rate of decrease in inertia slows down, is
typically the optimal number of clusters. In this plot, the curve starts
flattening around ( k = 4 ) to ( k = 5 ), suggesting that these cluster
counts may provide a good balance between grouping data points closely
within clusters and not using an excessive number of clusters.</p>
</div>
<div class="cell code" data-execution_count="77"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:1000}"
id="XjR6iWIEOGQJ" data-outputId="cef7ddb8-6ae5-494a-eae9-95ca5aba6ce1">
<div class="sourceCode" id="cb45"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>kmeans <span class="op">=</span> KMeans(n_clusters<span class="op">=</span><span class="dv">3</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>kmeans.fit(scaled_features)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> kmeans.labels_</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>scaled_features_df <span class="op">=</span> pd.DataFrame(scaled_features, columns<span class="op">=</span>features.columns)</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>scaled_features_df[<span class="st">&#39;Cluster&#39;</span>] <span class="op">=</span> labels</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>segment_summary <span class="op">=</span> scaled_features_df.groupby(<span class="st">&#39;Cluster&#39;</span>).mean()</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(segment_summary)</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>selected_features <span class="op">=</span> [<span class="st">&#39;MonthlyRevenue&#39;</span>, <span class="st">&#39;MonthlyMinutes&#39;</span>, <span class="st">&#39;TotalRecurringCharge&#39;</span>,</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&#39;MonthsInService&#39;</span>, <span class="st">&#39;UniqueSubs&#39;</span>, <span class="st">&#39;Handsets&#39;</span>]</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>segment_summary_filtered <span class="op">=</span> segment_summary[selected_features]</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">8</span>))</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>sns.heatmap(segment_summary_filtered, annot<span class="op">=</span><span class="va">True</span>, cmap<span class="op">=</span><span class="st">&#39;coolwarm&#39;</span>, fmt<span class="op">=</span><span class="st">&quot;.2f&quot;</span>, annot_kws<span class="op">=</span>{<span class="st">&quot;size&quot;</span>: <span class="dv">10</span>})</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&quot;Segment Summary for Selected Features&quot;</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">45</span>, ha<span class="op">=</span><span class="st">&#39;right&#39;</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>plt.yticks(fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>         MonthlyRevenue  MonthlyMinutes  TotalRecurringCharge  \
Cluster                                                         
0             -0.293360       -0.377553             -0.354240   
1              1.536276        1.642720              1.366647   
2             -0.281615       -0.273470             -0.210243   

         MonthsInService  UniqueSubs  Handsets  
Cluster                                         
0               1.210193    0.032868  0.470500  
1              -0.023197    0.004136  0.675265  
2              -0.523916   -0.015866 -0.384652  
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_5cdade6e6d334c1a8623e96f9dd6155b/b3b0494644846b28762a8429d0206c9d59745711.png" /></p>
</div>
</div>
<div class="cell markdown" id="w_vafJJRi7RF">
<p>This heatmap visualizes the average values of selected features
across different customer segments. Each segment represents a distinct
customer group based on their behavior and usage patterns:</p>
<ul>
<li><strong>Segment 0</strong>: Shows moderate Monthly Minutes and
Monthly Revenue with average Months in Service, indicating a balanced
usage and average service period.</li>
<li><strong>Segment 1</strong>: Stands out with the highest Monthly
Minutes (1388.43) and higher Monthly Revenue and Total Recurring Charge,
suggesting heavy users with a strong potential for high engagement or
churn.</li>
<li><strong>Segment 2</strong>: Similar to Segment 0 in Monthly Revenue
and Total Recurring Charge but with more Unique Subs, indicating
potentially shared plans.</li>
<li><strong>Segment 3</strong>: Has zero Monthly Minutes, high Total
Recurring Charge, and significantly high Unique Subs, indicating
customers who may hold multiple subscriptions but have low usage.</li>
</ul>
<p>This segmentation helps identify target groups for tailored retention
strategies, such as focusing on Segment 1 for loyalty incentives and
Segment 3 for engagement strategies.</p>
</div>
<div class="cell code" data-execution_count="89"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:673}"
id="EyKki4D2dbUI" data-outputId="e9331ec8-5dc0-4bbe-bdd2-5158a23f4374">
<div class="sourceCode" id="cb47"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>sns.boxplot(x<span class="op">=</span><span class="st">&#39;Segment&#39;</span>, y<span class="op">=</span><span class="st">&#39;MonthlyRevenue&#39;</span>, data<span class="op">=</span>df, palette<span class="op">=</span><span class="st">&#39;Set3&#39;</span>)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Monthly Revenue Distribution by Segment&#39;</span>)</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Segment&#39;</span>)</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Monthly Revenue&#39;</span>)</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output stream stderr">
<pre><code>&lt;ipython-input-89-6056c7af34ce&gt;:2: FutureWarning: 

Passing `palette` without assigning `hue` is deprecated and will be removed in v0.14.0. Assign the `x` variable to `hue` and set `legend=False` for the same effect.

  sns.boxplot(x=&#39;Segment&#39;, y=&#39;MonthlyRevenue&#39;, data=df, palette=&#39;Set3&#39;)
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_5cdade6e6d334c1a8623e96f9dd6155b/36ff444728de36e31ce9a2aa8e2c58a777142cf1.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="80"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:673}"
id="mDSCya3WObMl" data-outputId="6a2b7cc7-fee9-4448-ce78-3078f85194af">
<div class="sourceCode" id="cb49"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;Segment&#39;</span>] <span class="op">=</span> scaled_features_df[<span class="st">&#39;Cluster&#39;</span>]</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>sns.boxplot(x<span class="op">=</span><span class="st">&#39;Segment&#39;</span>, y<span class="op">=</span><span class="st">&#39;MonthlyRevenue&#39;</span>, data<span class="op">=</span>df, palette<span class="op">=</span><span class="st">&#39;Set3&#39;</span>)</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Monthly Revenue Distribution by Segment&#39;</span>)</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Segment&#39;</span>)</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Monthly Revenue&#39;</span>)</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output stream stderr">
<pre><code>&lt;ipython-input-80-1447a3f4a669&gt;:5: FutureWarning: 

Passing `palette` without assigning `hue` is deprecated and will be removed in v0.14.0. Assign the `x` variable to `hue` and set `legend=False` for the same effect.

  sns.boxplot(x=&#39;Segment&#39;, y=&#39;MonthlyRevenue&#39;, data=df, palette=&#39;Set3&#39;)
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_5cdade6e6d334c1a8623e96f9dd6155b/1f89a11354ffba8c732419a161f75ee7b492c416.png" /></p>
</div>
</div>
<div class="cell markdown" id="iXC6GRqbjKSV">
<p>This boxplot illustrates the distribution of Monthly Revenue across
the different customer segments:</p>
<ul>
<li><strong>Segment 1</strong> has the highest median Monthly Revenue,
with a significant number of high-revenue outliers, indicating this
segment includes heavy spenders.</li>
<li><strong>Segments 0 and 2</strong> show relatively lower Monthly
Revenue, with fewer outliers, suggesting moderate usage and spending
patterns.</li>
<li><strong>Segment 3</strong> has the lowest revenue distribution, with
minimal variance, indicating low engagement or possibly minimal service
usage.</li>
</ul>
<p>This plot highlights the revenue potential within each segment,
identifying Segment 1 as a valuable group for retention efforts due to
their higher spending. Segment 3 could be a target for engagement
strategies to increase revenue.</p>
</div>
<div class="cell code" data-execution_count="81"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:564}"
id="pUTEgO6LdnGs" data-outputId="e5af6464-c6f3-4f28-9419-c6d4b5020089">
<div class="sourceCode" id="cb51"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>segment_means <span class="op">=</span> df.groupby(<span class="st">&#39;Segment&#39;</span>)[[<span class="st">&#39;MonthlyMinutes&#39;</span>, <span class="st">&#39;TotalRecurringCharge&#39;</span>]].mean().reset_index()</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>sns.barplot(x<span class="op">=</span><span class="st">&#39;Segment&#39;</span>, y<span class="op">=</span><span class="st">&#39;MonthlyMinutes&#39;</span>, data<span class="op">=</span>segment_means, color<span class="op">=</span><span class="st">&#39;skyblue&#39;</span>, label<span class="op">=</span><span class="st">&#39;Monthly Minutes&#39;</span>)</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>sns.barplot(x<span class="op">=</span><span class="st">&#39;Segment&#39;</span>, y<span class="op">=</span><span class="st">&#39;TotalRecurringCharge&#39;</span>, data<span class="op">=</span>segment_means, color<span class="op">=</span><span class="st">&#39;salmon&#39;</span>, label<span class="op">=</span><span class="st">&#39;Total Recurring Charge&#39;</span>, alpha<span class="op">=</span><span class="fl">0.6</span>)</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Average Monthly Minutes and Total Recurring Charge by Segment&#39;</span>)</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Segment&#39;</span>)</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Average Value&#39;</span>)</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_5cdade6e6d334c1a8623e96f9dd6155b/f5acbcccfcc30965f04382f0d81909b57438d29d.png" /></p>
</div>
</div>
<div class="cell markdown" id="08vii8xhjWPw">
<p>This bar chart shows the average Monthly Minutes and Total Recurring
Charge for each customer segment:</p>
<ul>
<li><strong>Segment 1</strong> has the highest average Monthly Minutes
by far, indicating that this group heavily utilizes the service.
However, their Total Recurring Charge remains relatively low compared to
usage, possibly implying they are on high-usage plans or receive special
rates.</li>
<li><strong>Segments 0 and 2</strong> have moderate Monthly Minutes with
similarly modest Total Recurring Charges, reflecting balanced usage and
spending.</li>
<li><strong>Segment 3</strong> has very low Monthly Minutes and Total
Recurring Charge, suggesting minimal engagement with the service.</li>
</ul>
<p>Insights from this chart suggest focusing on increasing the Total
Recurring Charge for Segment 1 users through upsell opportunities, while
Segment 3 may need engagement strategies to boost usage and
spending.</p>
</div>
<div class="cell code" data-execution_count="82"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:564}"
id="Ryb5G5W0d0W5" data-outputId="684c7e8d-38a2-4579-ca97-ea0109023300">
<div class="sourceCode" id="cb52"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(x<span class="op">=</span><span class="st">&#39;Handsets&#39;</span>, y<span class="op">=</span><span class="st">&#39;UniqueSubs&#39;</span>, hue<span class="op">=</span><span class="st">&#39;Segment&#39;</span>, data<span class="op">=</span>df, palette<span class="op">=</span><span class="st">&#39;viridis&#39;</span>, s<span class="op">=</span><span class="dv">100</span>)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Handsets vs. Unique Subs by Segment&#39;</span>)</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Handsets&#39;</span>)</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Unique Subs&#39;</span>)</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>plt.legend(title<span class="op">=</span><span class="st">&#39;Segment&#39;</span>)</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_5cdade6e6d334c1a8623e96f9dd6155b/680b16050d96302929e8b0e268ba4ffef12c6764.png" /></p>
</div>
</div>
<div class="cell markdown" id="2ou0NleBjkmt">
<p>This scatter plot visualizes the relationship between the number of
handsets and unique subscribers across different customer segments:</p>
<ul>
<li><strong>Segments 0, 1, and 2</strong> generally have fewer handsets
and unique subscribers, with most data points clustered around low
values for both variables.</li>
<li><strong>Segment 3</strong> stands out with a notable data point
where a customer has an exceptionally high number of unique subscribers
(close to 200) with only one handset. This might indicate an atypical
usage pattern or data anomaly.</li>
</ul>
<p>The plot highlights that most segments maintain a relatively low
count of handsets and unique subscribers, suggesting that only a few
customers have multiple subscriptions or devices. Segment 3’s outlier
warrants further investigation to understand if it represents unique
customer behavior or an error in data collection.</p>
</div>
<div class="cell code" data-execution_count="83"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:467}"
id="3_X4BApjb6wz" data-outputId="9e7c53ee-9884-4f26-8b01-8308d4f73ac8">
<div class="sourceCode" id="cb53"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>segment_summary[<span class="st">&#39;MonthlyRevenue&#39;</span>].plot(kind<span class="op">=</span><span class="st">&#39;bar&#39;</span>, color<span class="op">=</span><span class="st">&#39;skyblue&#39;</span>)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&quot;Average Monthly Revenue by Segment&quot;</span>)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&quot;Segment&quot;</span>)</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&quot;Monthly Revenue&quot;</span>)</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_5cdade6e6d334c1a8623e96f9dd6155b/e8fa18f3a2668ff3eda423f50d5272bc42199b80.png" /></p>
</div>
</div>
<div class="cell markdown" id="2im4XclXjw3g">
<p>This bar chart shows the average monthly revenue across different
customer segments:</p>
<ul>
<li><strong>Segment 1</strong> generates the highest monthly revenue,
indicating this group has the highest spending or usage patterns among
all segments.</li>
<li><strong>Segment 3</strong> has moderate revenue, followed by
<strong>Segment 2</strong> and <strong>Segment 0</strong>, which have
lower average revenues.</li>
<li>The distinct revenue differences among segments suggest varying
levels of service usage or subscription plans, with Segment 1
potentially representing high-value customers.</li>
</ul>
<p>This insight can guide targeted strategies, with Segment 1 being
prioritized for retention efforts, while other segments may benefit from
upselling initiatives to increase their revenue contribution.</p>
</div>
<div class="cell code" data-execution_count="84"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:523}"
id="JRCdq2gz2LeE" data-outputId="b73f81ad-19fe-4dc0-ec73-f6c478d30e02">
<div class="sourceCode" id="cb54"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>null_values <span class="op">=</span> df.isnull().<span class="bu">sum</span>()</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>null_values[null_values <span class="op">&gt;</span> <span class="dv">0</span>]</span></code></pre></div>
<div class="output execute_result" data-execution_count="84">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>MonthlyRevenue</th>
      <td>156</td>
    </tr>
    <tr>
      <th>MonthlyMinutes</th>
      <td>156</td>
    </tr>
    <tr>
      <th>TotalRecurringCharge</th>
      <td>156</td>
    </tr>
    <tr>
      <th>DirectorAssistedCalls</th>
      <td>156</td>
    </tr>
    <tr>
      <th>OverageMinutes</th>
      <td>156</td>
    </tr>
    <tr>
      <th>RoamingCalls</th>
      <td>156</td>
    </tr>
    <tr>
      <th>PercChangeMinutes</th>
      <td>367</td>
    </tr>
    <tr>
      <th>PercChangeRevenues</th>
      <td>367</td>
    </tr>
    <tr>
      <th>Handsets</th>
      <td>1</td>
    </tr>
    <tr>
      <th>HandsetModels</th>
      <td>1</td>
    </tr>
    <tr>
      <th>CurrentEquipmentDays</th>
      <td>1</td>
    </tr>
    <tr>
      <th>AgeHH1</th>
      <td>909</td>
    </tr>
    <tr>
      <th>AgeHH2</th>
      <td>909</td>
    </tr>
    <tr>
      <th>Segment</th>
      <td>157</td>
    </tr>
  </tbody>
</table>
</div><br><label><b>dtype:</b> int64</label>
</div>
</div>
<div class="cell code" data-execution_count="85"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="o3xEkYTr2UgB" data-outputId="622e3ec0-5a1c-4a09-8ed4-f23987d198de">
<div class="sourceCode" id="cb55"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>unique_values <span class="op">=</span> df.nunique()</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(unique_values)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>CustomerID                   51047
Churn                            2
MonthlyRevenue               12665
MonthlyMinutes                2719
TotalRecurringCharge           214
DirectorAssistedCalls          146
OverageMinutes                 746
RoamingCalls                   530
PercChangeMinutes             2262
PercChangeRevenues            2899
DroppedCalls                   285
BlockedCalls                   373
UnansweredCalls                840
CustomerCareCalls              185
ThreewayCalls                   78
ReceivedCalls                 6121
OutboundCalls                  787
InboundCalls                   472
PeakCallsInOut                1839
OffPeakCallsInOut             1669
DroppedBlockedCalls            447
CallForwardingCalls             31
CallWaitingCalls               223
MonthsInService                 56
UniqueSubs                      15
ActiveSubs                      12
ServiceArea                    748
Handsets                        23
HandsetModels                   13
CurrentEquipmentDays          1438
AgeHH1                          43
AgeHH2                          43
ChildrenInHH                     2
HandsetRefurbished               2
HandsetWebCapable                2
TruckOwner                       2
RVOwner                          2
Homeownership                    2
BuysViaMailOrder                 2
RespondsToMailOffers             2
OptOutMailings                   2
NonUSTravel                      2
OwnsComputer                     2
HasCreditCard                    2
RetentionCalls                   5
RetentionOffersAccepted          4
NewCellphoneUser                 2
NotNewCellphoneUser              2
ReferralsMadeBySubscriber       13
IncomeGroup                     10
OwnsMotorcycle                   2
AdjustmentsToCreditRating       15
HandsetPrice                    16
MadeCallToRetentionTeam          2
CreditRating                     7
PrizmCode                        4
Occupation                       8
MaritalStatus                    3
Segment                          3
dtype: int64
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="86" id="XJ8VjwEiAjtf">
<div class="sourceCode" id="cb57"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>categorical_cols <span class="op">=</span> df.select_dtypes(include<span class="op">=</span>[<span class="st">&#39;object&#39;</span>]).columns</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>label_encoders <span class="op">=</span> {}</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> categorical_cols:</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>    le <span class="op">=</span> LabelEncoder()</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>    df[col] <span class="op">=</span> le.fit_transform(df[col].astype(<span class="bu">str</span>))</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>    label_encoders[col] <span class="op">=</span> le</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>one_hot_encoded_df <span class="op">=</span> pd.get_dummies(df, columns<span class="op">=</span>categorical_cols)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="87" id="FjMXGGtE_rPu">
<div class="sourceCode" id="cb58"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.dropna()</span></code></pre></div>
</div>
<div class="cell markdown" id="MgNfIOxuO7wP">
<p>#Statistical Test</p>
</div>
<div class="cell code" data-execution_count="91"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:1000}"
id="V2jkpcwYR6Ht" data-outputId="7a736b47-4f22-4d01-d6e6-4d1875501717">
<div class="sourceCode" id="cb59"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>normality_results <span class="op">=</span> {}</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> df.select_dtypes(include<span class="op">=</span><span class="st">&#39;number&#39;</span>).columns:</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>    stat, p_value <span class="op">=</span> stats.shapiro(df[col])</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>    normality_results[col] <span class="op">=</span> {<span class="st">&#39;Statistic&#39;</span>: stat, <span class="st">&#39;P-Value&#39;</span>: p_value,</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&#39;Is_Normal&#39;</span>: p_value <span class="op">&gt;</span> <span class="fl">0.05</span>}</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a DataFrame from the normality results</span></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>normality_results <span class="op">=</span> {}</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> df.select_dtypes(include<span class="op">=</span><span class="st">&#39;number&#39;</span>).columns:</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>    stat, p_value <span class="op">=</span> stats.shapiro(df[col])</span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>    normality_results[col] <span class="op">=</span> {<span class="st">&#39;Statistic&#39;</span>: stat, <span class="st">&#39;P-Value&#39;</span>: p_value,</span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&#39;Is_Normal&#39;</span>: p_value <span class="op">&gt;</span> <span class="fl">0.05</span>}</span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a DataFrame from the normality results</span></span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>normality_df <span class="op">=</span> pd.DataFrame.from_dict(normality_results, orient<span class="op">=</span><span class="st">&#39;index&#39;</span>)</span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the DataFrame</span></span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Normality Test Results:&quot;</span>)</span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(normality_df)</span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Normality Test Results:&quot;</span>)</span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true" tabindex="-1"></a>normality_d</span></code></pre></div>
<div class="output stream stderr">
<pre><code>/usr/local/lib/python3.10/dist-packages/scipy/stats/_axis_nan_policy.py:531: UserWarning: scipy.stats.shapiro: For N &gt; 5000, computed p-value may not be accurate. Current N is 49699.
  res = hypotest_fun_out(*samples, **kwds)
/usr/local/lib/python3.10/dist-packages/scipy/stats/_axis_nan_policy.py:531: UserWarning: scipy.stats.shapiro: For N &gt; 5000, computed p-value may not be accurate. Current N is 49699.
  res = hypotest_fun_out(*samples, **kwds)
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>Normality Test Results:
                           Statistic        P-Value  Is_Normal
CustomerID                  0.951896   2.715286e-79      False
Churn                       0.566634  2.655069e-137      False
MonthlyRevenue              0.713674  3.921416e-125      False
MonthlyMinutes              0.806748  4.051266e-114      False
TotalRecurringCharge        0.906262   3.393527e-95      False
DirectorAssistedCalls       0.397611  2.218310e-147      False
OverageMinutes              0.434358  1.996036e-145      False
RoamingCalls                0.078770  6.481527e-161      False
PercChangeMinutes           0.807284  4.824978e-114      False
PercChangeRevenues          0.575472  1.103146e-136      False
DroppedCalls                0.620399  2.375495e-133      False
BlockedCalls                0.354467  1.524828e-149      False
UnansweredCalls             0.651345  7.617759e-131      False
CustomerCareCalls           0.371037  9.957031e-149      False
ThreewayCalls               0.234733  6.241093e-155      False
ReceivedCalls               0.682943  4.497628e-128      False
OutboundCalls               0.681071  3.035278e-128      False
InboundCalls                0.505802  2.803298e-141      False
PeakCallsInOut              0.730505  2.109907e-123      False
OffPeakCallsInOut           0.677296  1.381275e-128      False
DroppedBlockedCalls         0.583841  4.354944e-136      False
CallForwardingCalls         0.005349  2.015786e-163      False
CallWaitingCalls            0.319329  3.274719e-151      False
MonthsInService             0.915736   1.479274e-92      False
UniqueSubs                  0.329680  9.962947e-151      False
ActiveSubs                  0.534744  1.912952e-139      False
ServiceArea                 0.955228   1.139334e-77      False
Handsets                    0.632144  2.017454e-132      False
HandsetModels               0.648479  4.381517e-131      False
CurrentEquipmentDays        0.935787   5.376820e-86      False
AgeHH1                      0.894099   2.896375e-98      False
AgeHH2                      0.797014  1.815141e-115      False
ChildrenInHH                0.535814  2.246444e-139      False
HandsetRefurbished          0.409484  9.236604e-147      False
HandsetWebCapable           0.337097  2.232256e-150      False
TruckOwner                  0.479452  7.232257e-143      False
RVOwner                     0.307624  9.475688e-152      False
Homeownership               0.588912  1.012739e-135      False
BuysViaMailOrder            0.610897  4.391646e-134      False
RespondsToMailOffers        0.616640  1.212883e-133      False
OptOutMailings              0.096727  2.832287e-160      False
NonUSTravel                 0.244715  1.638525e-154      False
OwnsComputer                0.476957  5.159544e-143      False
HasCreditCard               0.582905  3.730584e-136      False
RetentionCalls              0.165022  9.935230e-158      False
RetentionOffersAccepted     0.105264  5.762731e-160      False
NewCellphoneUser            0.482543  1.101141e-142      False
NotNewCellphoneUser         0.408831  8.533411e-147      False
ReferralsMadeBySubscriber   0.181440  4.333011e-157      False
IncomeGroup                 0.889402   2.281997e-99      False
OwnsMotorcycle              0.090208  1.653183e-160      False
AdjustmentsToCreditRating   0.119296  1.877133e-159      False
HandsetPrice                0.717129  8.734015e-125      False
MadeCallToRetentionTeam     0.168202  1.318833e-157      False
CreditRating                0.870627  2.084754e-103      False
PrizmCode                   0.767688  3.268152e-119      False
Occupation                  0.651643  8.070588e-131      False
MaritalStatus               0.797598  2.179055e-115      False
Segment                     0.688555  1.481031e-127      False
Normality Test Results:
</code></pre>
</div>
<div class="output execute_result" data-execution_count="91">

  <div id="df-c9010f1a-0454-431e-ab2b-108dff660fcc" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Statistic</th>
      <th>P-Value</th>
      <th>Is_Normal</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>CustomerID</th>
      <td>0.951896</td>
      <td>2.715286e-79</td>
      <td>False</td>
    </tr>
    <tr>
      <th>Churn</th>
      <td>0.566634</td>
      <td>2.655069e-137</td>
      <td>False</td>
    </tr>
    <tr>
      <th>MonthlyRevenue</th>
      <td>0.713674</td>
      <td>3.921416e-125</td>
      <td>False</td>
    </tr>
    <tr>
      <th>MonthlyMinutes</th>
      <td>0.806748</td>
      <td>4.051266e-114</td>
      <td>False</td>
    </tr>
    <tr>
      <th>TotalRecurringCharge</th>
      <td>0.906262</td>
      <td>3.393527e-95</td>
      <td>False</td>
    </tr>
    <tr>
      <th>DirectorAssistedCalls</th>
      <td>0.397611</td>
      <td>2.218310e-147</td>
      <td>False</td>
    </tr>
    <tr>
      <th>OverageMinutes</th>
      <td>0.434358</td>
      <td>1.996036e-145</td>
      <td>False</td>
    </tr>
    <tr>
      <th>RoamingCalls</th>
      <td>0.078770</td>
      <td>6.481527e-161</td>
      <td>False</td>
    </tr>
    <tr>
      <th>PercChangeMinutes</th>
      <td>0.807284</td>
      <td>4.824978e-114</td>
      <td>False</td>
    </tr>
    <tr>
      <th>PercChangeRevenues</th>
      <td>0.575472</td>
      <td>1.103146e-136</td>
      <td>False</td>
    </tr>
    <tr>
      <th>DroppedCalls</th>
      <td>0.620399</td>
      <td>2.375495e-133</td>
      <td>False</td>
    </tr>
    <tr>
      <th>BlockedCalls</th>
      <td>0.354467</td>
      <td>1.524828e-149</td>
      <td>False</td>
    </tr>
    <tr>
      <th>UnansweredCalls</th>
      <td>0.651345</td>
      <td>7.617759e-131</td>
      <td>False</td>
    </tr>
    <tr>
      <th>CustomerCareCalls</th>
      <td>0.371037</td>
      <td>9.957031e-149</td>
      <td>False</td>
    </tr>
    <tr>
      <th>ThreewayCalls</th>
      <td>0.234733</td>
      <td>6.241093e-155</td>
      <td>False</td>
    </tr>
    <tr>
      <th>ReceivedCalls</th>
      <td>0.682943</td>
      <td>4.497628e-128</td>
      <td>False</td>
    </tr>
    <tr>
      <th>OutboundCalls</th>
      <td>0.681071</td>
      <td>3.035278e-128</td>
      <td>False</td>
    </tr>
    <tr>
      <th>InboundCalls</th>
      <td>0.505802</td>
      <td>2.803298e-141</td>
      <td>False</td>
    </tr>
    <tr>
      <th>PeakCallsInOut</th>
      <td>0.730505</td>
      <td>2.109907e-123</td>
      <td>False</td>
    </tr>
    <tr>
      <th>OffPeakCallsInOut</th>
      <td>0.677296</td>
      <td>1.381275e-128</td>
      <td>False</td>
    </tr>
    <tr>
      <th>DroppedBlockedCalls</th>
      <td>0.583841</td>
      <td>4.354944e-136</td>
      <td>False</td>
    </tr>
    <tr>
      <th>CallForwardingCalls</th>
      <td>0.005349</td>
      <td>2.015786e-163</td>
      <td>False</td>
    </tr>
    <tr>
      <th>CallWaitingCalls</th>
      <td>0.319329</td>
      <td>3.274719e-151</td>
      <td>False</td>
    </tr>
    <tr>
      <th>MonthsInService</th>
      <td>0.915736</td>
      <td>1.479274e-92</td>
      <td>False</td>
    </tr>
    <tr>
      <th>UniqueSubs</th>
      <td>0.329680</td>
      <td>9.962947e-151</td>
      <td>False</td>
    </tr>
    <tr>
      <th>ActiveSubs</th>
      <td>0.534744</td>
      <td>1.912952e-139</td>
      <td>False</td>
    </tr>
    <tr>
      <th>ServiceArea</th>
      <td>0.955228</td>
      <td>1.139334e-77</td>
      <td>False</td>
    </tr>
    <tr>
      <th>Handsets</th>
      <td>0.632144</td>
      <td>2.017454e-132</td>
      <td>False</td>
    </tr>
    <tr>
      <th>HandsetModels</th>
      <td>0.648479</td>
      <td>4.381517e-131</td>
      <td>False</td>
    </tr>
    <tr>
      <th>CurrentEquipmentDays</th>
      <td>0.935787</td>
      <td>5.376820e-86</td>
      <td>False</td>
    </tr>
    <tr>
      <th>AgeHH1</th>
      <td>0.894099</td>
      <td>2.896375e-98</td>
      <td>False</td>
    </tr>
    <tr>
      <th>AgeHH2</th>
      <td>0.797014</td>
      <td>1.815141e-115</td>
      <td>False</td>
    </tr>
    <tr>
      <th>ChildrenInHH</th>
      <td>0.535814</td>
      <td>2.246444e-139</td>
      <td>False</td>
    </tr>
    <tr>
      <th>HandsetRefurbished</th>
      <td>0.409484</td>
      <td>9.236604e-147</td>
      <td>False</td>
    </tr>
    <tr>
      <th>HandsetWebCapable</th>
      <td>0.337097</td>
      <td>2.232256e-150</td>
      <td>False</td>
    </tr>
    <tr>
      <th>TruckOwner</th>
      <td>0.479452</td>
      <td>7.232257e-143</td>
      <td>False</td>
    </tr>
    <tr>
      <th>RVOwner</th>
      <td>0.307624</td>
      <td>9.475688e-152</td>
      <td>False</td>
    </tr>
    <tr>
      <th>Homeownership</th>
      <td>0.588912</td>
      <td>1.012739e-135</td>
      <td>False</td>
    </tr>
    <tr>
      <th>BuysViaMailOrder</th>
      <td>0.610897</td>
      <td>4.391646e-134</td>
      <td>False</td>
    </tr>
    <tr>
      <th>RespondsToMailOffers</th>
      <td>0.616640</td>
      <td>1.212883e-133</td>
      <td>False</td>
    </tr>
    <tr>
      <th>OptOutMailings</th>
      <td>0.096727</td>
      <td>2.832287e-160</td>
      <td>False</td>
    </tr>
    <tr>
      <th>NonUSTravel</th>
      <td>0.244715</td>
      <td>1.638525e-154</td>
      <td>False</td>
    </tr>
    <tr>
      <th>OwnsComputer</th>
      <td>0.476957</td>
      <td>5.159544e-143</td>
      <td>False</td>
    </tr>
    <tr>
      <th>HasCreditCard</th>
      <td>0.582905</td>
      <td>3.730584e-136</td>
      <td>False</td>
    </tr>
    <tr>
      <th>RetentionCalls</th>
      <td>0.165022</td>
      <td>9.935230e-158</td>
      <td>False</td>
    </tr>
    <tr>
      <th>RetentionOffersAccepted</th>
      <td>0.105264</td>
      <td>5.762731e-160</td>
      <td>False</td>
    </tr>
    <tr>
      <th>NewCellphoneUser</th>
      <td>0.482543</td>
      <td>1.101141e-142</td>
      <td>False</td>
    </tr>
    <tr>
      <th>NotNewCellphoneUser</th>
      <td>0.408831</td>
      <td>8.533411e-147</td>
      <td>False</td>
    </tr>
    <tr>
      <th>ReferralsMadeBySubscriber</th>
      <td>0.181440</td>
      <td>4.333011e-157</td>
      <td>False</td>
    </tr>
    <tr>
      <th>IncomeGroup</th>
      <td>0.889402</td>
      <td>2.281997e-99</td>
      <td>False</td>
    </tr>
    <tr>
      <th>OwnsMotorcycle</th>
      <td>0.090208</td>
      <td>1.653183e-160</td>
      <td>False</td>
    </tr>
    <tr>
      <th>AdjustmentsToCreditRating</th>
      <td>0.119296</td>
      <td>1.877133e-159</td>
      <td>False</td>
    </tr>
    <tr>
      <th>HandsetPrice</th>
      <td>0.717129</td>
      <td>8.734015e-125</td>
      <td>False</td>
    </tr>
    <tr>
      <th>MadeCallToRetentionTeam</th>
      <td>0.168202</td>
      <td>1.318833e-157</td>
      <td>False</td>
    </tr>
    <tr>
      <th>CreditRating</th>
      <td>0.870627</td>
      <td>2.084754e-103</td>
      <td>False</td>
    </tr>
    <tr>
      <th>PrizmCode</th>
      <td>0.767688</td>
      <td>3.268152e-119</td>
      <td>False</td>
    </tr>
    <tr>
      <th>Occupation</th>
      <td>0.651643</td>
      <td>8.070588e-131</td>
      <td>False</td>
    </tr>
    <tr>
      <th>MaritalStatus</th>
      <td>0.797598</td>
      <td>2.179055e-115</td>
      <td>False</td>
    </tr>
    <tr>
      <th>Segment</th>
      <td>0.688555</td>
      <td>1.481031e-127</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-c9010f1a-0454-431e-ab2b-108dff660fcc')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-c9010f1a-0454-431e-ab2b-108dff660fcc button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-c9010f1a-0454-431e-ab2b-108dff660fcc');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-b5dad2b9-73d8-4960-a169-64274adebf0e">
  <button class="colab-df-quickchart" onclick="quickchart('df-b5dad2b9-73d8-4960-a169-64274adebf0e')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-b5dad2b9-73d8-4960-a169-64274adebf0e button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

  <div id="id_1e26b7b6-c0fd-491b-ad80-b992862a1c06">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('normality_df')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_1e26b7b6-c0fd-491b-ad80-b992862a1c06 button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('normality_df');
      }
      })();
    </script>
  </div>

    </div>
  </div>

</div>
</div>
<div class="cell markdown" id="5PBTfAPIkQ7b">
<p>This table displays the results of a normality test for various
columns in the dataset, indicating whether each column follows a normal
distribution.</p>
<ul>
<li><strong>Statistic and P-Value</strong>: These values reflect the
test outcome, where a low p-value (usually less than 0.05) indicates the
data significantly deviates from normality.</li>
<li><strong>Is_Normal</strong>: A "False" value across all features here
shows that none of these variables follow a normal distribution.</li>
</ul>
</div>
<div class="cell code" data-execution_count="93"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="okOZKWILTdd8" data-outputId="73e71c68-40f7-4dc3-8d28-f57ec7bb2182">
<div class="sourceCode" id="cb62"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> analyze_outliers(df):</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>    numerical_cols <span class="op">=</span> df.select_dtypes(include<span class="op">=</span>[<span class="st">&#39;float64&#39;</span>, <span class="st">&#39;int64&#39;</span>]).columns</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>    univariate_outliers <span class="op">=</span> []</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>    multivariate_potential <span class="op">=</span> []</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> col <span class="kw">in</span> numerical_cols:</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>        Q1 <span class="op">=</span> df[col].quantile(<span class="fl">0.25</span>)</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>        Q3 <span class="op">=</span> df[col].quantile(<span class="fl">0.75</span>)</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>        IQR <span class="op">=</span> Q3 <span class="op">-</span> Q1</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>        lower_bound <span class="op">=</span> Q1 <span class="op">-</span> <span class="fl">1.5</span> <span class="op">*</span> IQR</span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>        upper_bound <span class="op">=</span> Q3 <span class="op">+</span> <span class="fl">1.5</span> <span class="op">*</span> IQR</span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> df[(df[col] <span class="op">&lt;</span> lower_bound) <span class="op">|</span> (df[col] <span class="op">&gt;</span> upper_bound)].empty:</span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>            univariate_outliers.append(col)</span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(numerical_cols) <span class="op">&gt;</span> <span class="dv">1</span>:</span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(numerical_cols) <span class="op">-</span> <span class="dv">1</span>):</span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a>            col1 <span class="op">=</span> numerical_cols[i]</span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a>            col2 <span class="op">=</span> numerical_cols[i <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a>            correlation <span class="op">=</span> df[[col1, col2]].corr().iloc[<span class="dv">0</span>, <span class="dv">1</span>]</span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">abs</span>(correlation) <span class="op">&gt;</span> <span class="fl">0.5</span>:</span>
<span id="cb62-20"><a href="#cb62-20" aria-hidden="true" tabindex="-1"></a>                multivariate_potential.append((col1, col2))</span>
<span id="cb62-21"><a href="#cb62-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-22"><a href="#cb62-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> univariate_outliers, multivariate_potential</span>
<span id="cb62-23"><a href="#cb62-23" aria-hidden="true" tabindex="-1"></a>univariate_outliers, multivariate_potential <span class="op">=</span> analyze_outliers(df)</span>
<span id="cb62-24"><a href="#cb62-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-25"><a href="#cb62-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Potential Univariate Outliers :&quot;</span>)</span>
<span id="cb62-26"><a href="#cb62-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(univariate_outliers)</span>
<span id="cb62-27"><a href="#cb62-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-28"><a href="#cb62-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Potential Multivariate Outliers (Column Pairs):&quot;</span>)</span>
<span id="cb62-29"><a href="#cb62-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(multivariate_potential)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>
Potential Univariate Outliers :
[&#39;MonthlyRevenue&#39;, &#39;MonthlyMinutes&#39;, &#39;TotalRecurringCharge&#39;, &#39;DirectorAssistedCalls&#39;, &#39;OverageMinutes&#39;, &#39;RoamingCalls&#39;, &#39;PercChangeMinutes&#39;, &#39;PercChangeRevenues&#39;, &#39;DroppedCalls&#39;, &#39;BlockedCalls&#39;, &#39;UnansweredCalls&#39;, &#39;CustomerCareCalls&#39;, &#39;ThreewayCalls&#39;, &#39;ReceivedCalls&#39;, &#39;OutboundCalls&#39;, &#39;InboundCalls&#39;, &#39;PeakCallsInOut&#39;, &#39;OffPeakCallsInOut&#39;, &#39;DroppedBlockedCalls&#39;, &#39;CallForwardingCalls&#39;, &#39;CallWaitingCalls&#39;, &#39;MonthsInService&#39;, &#39;UniqueSubs&#39;, &#39;ActiveSubs&#39;, &#39;Handsets&#39;, &#39;HandsetModels&#39;, &#39;CurrentEquipmentDays&#39;, &#39;ChildrenInHH&#39;, &#39;HandsetRefurbished&#39;, &#39;HandsetWebCapable&#39;, &#39;TruckOwner&#39;, &#39;RVOwner&#39;, &#39;OptOutMailings&#39;, &#39;NonUSTravel&#39;, &#39;OwnsComputer&#39;, &#39;RetentionCalls&#39;, &#39;RetentionOffersAccepted&#39;, &#39;NewCellphoneUser&#39;, &#39;NotNewCellphoneUser&#39;, &#39;ReferralsMadeBySubscriber&#39;, &#39;OwnsMotorcycle&#39;, &#39;AdjustmentsToCreditRating&#39;, &#39;MadeCallToRetentionTeam&#39;, &#39;Occupation&#39;]

Potential Multivariate Outliers (Column Pairs):
[(&#39;MonthlyRevenue&#39;, &#39;MonthlyMinutes&#39;), (&#39;MonthlyMinutes&#39;, &#39;TotalRecurringCharge&#39;), (&#39;PercChangeMinutes&#39;, &#39;PercChangeRevenues&#39;), (&#39;ReceivedCalls&#39;, &#39;OutboundCalls&#39;), (&#39;OutboundCalls&#39;, &#39;InboundCalls&#39;), (&#39;InboundCalls&#39;, &#39;PeakCallsInOut&#39;), (&#39;PeakCallsInOut&#39;, &#39;OffPeakCallsInOut&#39;), (&#39;OffPeakCallsInOut&#39;, &#39;DroppedBlockedCalls&#39;), (&#39;UniqueSubs&#39;, &#39;ActiveSubs&#39;), (&#39;Handsets&#39;, &#39;HandsetModels&#39;), (&#39;AgeHH1&#39;, &#39;AgeHH2&#39;), (&#39;TruckOwner&#39;, &#39;RVOwner&#39;), (&#39;BuysViaMailOrder&#39;, &#39;RespondsToMailOffers&#39;), (&#39;RetentionCalls&#39;, &#39;RetentionOffersAccepted&#39;)]
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="94"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="bMQPGQBIWdgV" data-outputId="8a073fe0-af85-4c9d-afa8-589e94be8ec1">
<div class="sourceCode" id="cb64"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_univariate_outliers(df):</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>    numerical_cols <span class="op">=</span> df.select_dtypes(include<span class="op">=</span>[<span class="st">&#39;float64&#39;</span>, <span class="st">&#39;int64&#39;</span>]).columns</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>    outlier_counts <span class="op">=</span> {}</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> col <span class="kw">in</span> numerical_cols:</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>        Q1 <span class="op">=</span> df[col].quantile(<span class="fl">0.25</span>)  <span class="co"># 25th percentile</span></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>        Q3 <span class="op">=</span> df[col].quantile(<span class="fl">0.75</span>)  <span class="co"># 75th percentile</span></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>        IQR <span class="op">=</span> Q3 <span class="op">-</span> Q1  <span class="co"># Interquartile Range</span></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Define bounds for outliers</span></span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>        lower_bound <span class="op">=</span> Q1 <span class="op">-</span> <span class="fl">1.5</span> <span class="op">*</span> IQR</span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>        upper_bound <span class="op">=</span> Q3 <span class="op">+</span> <span class="fl">1.5</span> <span class="op">*</span> IQR</span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Count outliers</span></span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a>        outliers <span class="op">=</span> df[(df[col] <span class="op">&lt;</span> lower_bound) <span class="op">|</span> (df[col] <span class="op">&gt;</span> upper_bound)]</span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a>        outlier_counts[col] <span class="op">=</span> <span class="bu">len</span>(outliers)</span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-18"><a href="#cb64-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> outlier_counts</span>
<span id="cb64-19"><a href="#cb64-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-20"><a href="#cb64-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the outlier counts</span></span>
<span id="cb64-21"><a href="#cb64-21" aria-hidden="true" tabindex="-1"></a>outlier_counts <span class="op">=</span> count_univariate_outliers(df)</span>
<span id="cb64-22"><a href="#cb64-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-23"><a href="#cb64-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the results</span></span>
<span id="cb64-24"><a href="#cb64-24" aria-hidden="true" tabindex="-1"></a>outlier_df <span class="op">=</span> pd.DataFrame(outlier_counts.items(), columns<span class="op">=</span>[<span class="st">&#39;Column&#39;</span>, <span class="st">&#39;Outlier Count&#39;</span>])</span>
<span id="cb64-25"><a href="#cb64-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(outlier_df)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>                       Column  Outlier Count
0                  CustomerID              0
1                       Churn              0
2              MonthlyRevenue           2909
3              MonthlyMinutes           2516
4        TotalRecurringCharge            796
5       DirectorAssistedCalls           5374
6              OverageMinutes           5795
7                RoamingCalls           8612
8           PercChangeMinutes           6676
9          PercChangeRevenues          13011
10               DroppedCalls           3613
11               BlockedCalls           5379
12            UnansweredCalls           3526
13          CustomerCareCalls           6569
14              ThreewayCalls           4486
15              ReceivedCalls           3542
16              OutboundCalls           3249
17               InboundCalls           4835
18             PeakCallsInOut           2756
19          OffPeakCallsInOut           3526
20        DroppedBlockedCalls           3826
21        CallForwardingCalls            226
22           CallWaitingCalls           7234
23            MonthsInService           1152
24                 UniqueSubs           1790
25                 ActiveSubs            564
26                ServiceArea              0
27                   Handsets           4286
28              HandsetModels           1954
29       CurrentEquipmentDays           1375
30                     AgeHH1              0
31                     AgeHH2              0
32               ChildrenInHH          12265
33         HandsetRefurbished           6894
34          HandsetWebCapable           4841
35                 TruckOwner           9484
36                    RVOwner           4140
37              Homeownership              0
38           BuysViaMailOrder              0
39       RespondsToMailOffers              0
40             OptOutMailings            742
41                NonUSTravel           2854
42               OwnsComputer           9378
43              HasCreditCard              0
44             RetentionCalls           1617
45    RetentionOffersAccepted            857
46           NewCellphoneUser           9617
47        NotNewCellphoneUser           6873
48  ReferralsMadeBySubscriber           2323
49                IncomeGroup              0
50             OwnsMotorcycle            675
51  AdjustmentsToCreditRating           1777
52               HandsetPrice              0
53    MadeCallToRetentionTeam           1617
54               CreditRating              0
55                  PrizmCode              0
56                 Occupation          13291
57              MaritalStatus              0
58                    Segment              0
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="95"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:1000}"
id="TTOAtiSScGkk" data-outputId="2cb37603-1cf3-435a-f5f9-2ca5fb6e4311">
<div class="sourceCode" id="cb66"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>correlation_matrix <span class="op">=</span> df.corr()</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">35</span>, <span class="dv">40</span>))</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>sns.heatmap(correlation_matrix, annot<span class="op">=</span><span class="va">True</span>, cmap<span class="op">=</span><span class="st">&#39;coolwarm&#39;</span>, fmt<span class="op">=</span><span class="st">&#39;.2f&#39;</span>, linewidths<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Correlation Matrix Heatmap&#39;</span>)</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_5cdade6e6d334c1a8623e96f9dd6155b/175e8ff781e12dfa23db7202278e5bcbd348348d.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="96"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="hBA_LfSLd0-j" data-outputId="fcae26c5-5601-4e73-f737-5b6867a2cc72">
<div class="sourceCode" id="cb67"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>df.columns</span></code></pre></div>
<div class="output execute_result" data-execution_count="96">
<pre><code>Index([&#39;CustomerID&#39;, &#39;Churn&#39;, &#39;MonthlyRevenue&#39;, &#39;MonthlyMinutes&#39;,
       &#39;TotalRecurringCharge&#39;, &#39;DirectorAssistedCalls&#39;, &#39;OverageMinutes&#39;,
       &#39;RoamingCalls&#39;, &#39;PercChangeMinutes&#39;, &#39;PercChangeRevenues&#39;,
       &#39;DroppedCalls&#39;, &#39;BlockedCalls&#39;, &#39;UnansweredCalls&#39;, &#39;CustomerCareCalls&#39;,
       &#39;ThreewayCalls&#39;, &#39;ReceivedCalls&#39;, &#39;OutboundCalls&#39;, &#39;InboundCalls&#39;,
       &#39;PeakCallsInOut&#39;, &#39;OffPeakCallsInOut&#39;, &#39;DroppedBlockedCalls&#39;,
       &#39;CallForwardingCalls&#39;, &#39;CallWaitingCalls&#39;, &#39;MonthsInService&#39;,
       &#39;UniqueSubs&#39;, &#39;ActiveSubs&#39;, &#39;ServiceArea&#39;, &#39;Handsets&#39;, &#39;HandsetModels&#39;,
       &#39;CurrentEquipmentDays&#39;, &#39;AgeHH1&#39;, &#39;AgeHH2&#39;, &#39;ChildrenInHH&#39;,
       &#39;HandsetRefurbished&#39;, &#39;HandsetWebCapable&#39;, &#39;TruckOwner&#39;, &#39;RVOwner&#39;,
       &#39;Homeownership&#39;, &#39;BuysViaMailOrder&#39;, &#39;RespondsToMailOffers&#39;,
       &#39;OptOutMailings&#39;, &#39;NonUSTravel&#39;, &#39;OwnsComputer&#39;, &#39;HasCreditCard&#39;,
       &#39;RetentionCalls&#39;, &#39;RetentionOffersAccepted&#39;, &#39;NewCellphoneUser&#39;,
       &#39;NotNewCellphoneUser&#39;, &#39;ReferralsMadeBySubscriber&#39;, &#39;IncomeGroup&#39;,
       &#39;OwnsMotorcycle&#39;, &#39;AdjustmentsToCreditRating&#39;, &#39;HandsetPrice&#39;,
       &#39;MadeCallToRetentionTeam&#39;, &#39;CreditRating&#39;, &#39;PrizmCode&#39;, &#39;Occupation&#39;,
       &#39;MaritalStatus&#39;, &#39;Segment&#39;],
      dtype=&#39;object&#39;)</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="97" id="DnHl0kUmfNME">
<div class="sourceCode" id="cb69"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>columns_to_keep <span class="op">=</span> [</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Churn&#39;</span>, <span class="st">&#39;MonthlyRevenue&#39;</span>, <span class="st">&#39;MonthlyMinutes&#39;</span>, <span class="st">&#39;TotalRecurringCharge&#39;</span>,</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;OverageMinutes&#39;</span>, <span class="st">&#39;RoamingCalls&#39;</span>, <span class="st">&#39;PercChangeMinutes&#39;</span>, <span class="st">&#39;PercChangeRevenues&#39;</span>,</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;ThreewayCalls&#39;</span>, <span class="st">&#39;ReceivedCalls&#39;</span>, <span class="st">&#39;OutboundCalls&#39;</span>, <span class="st">&#39;InboundCalls&#39;</span>,</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;PeakCallsInOut&#39;</span>, <span class="st">&#39;OffPeakCallsInOut&#39;</span>,<span class="st">&#39;MonthsInService&#39;</span>, <span class="st">&#39;UniqueSubs&#39;</span>,</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;ActiveSubs&#39;</span>, <span class="st">&#39;ServiceArea&#39;</span>,<span class="st">&#39;CreditRating&#39;</span>, <span class="st">&#39;IncomeGroup&#39;</span></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df[columns_to_keep]</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="98" id="ra7vQLNihDzt">
<div class="sourceCode" id="cb70"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>df.rename(columns<span class="op">=</span>{<span class="st">&#39;OverageMinutes&#39;</span>: <span class="st">&#39;AverageMinutes&#39;</span>}, inplace<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="99"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:226}"
id="btRC_km7gGX1" data-outputId="549d5cc7-0328-482f-ae80-89ef1cad22e5">
<div class="sourceCode" id="cb71"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>df.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="99">

  <div id="df-d145cd09-8c91-4ddb-94e3-fcb1469de02f" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Churn</th>
      <th>MonthlyRevenue</th>
      <th>MonthlyMinutes</th>
      <th>TotalRecurringCharge</th>
      <th>AverageMinutes</th>
      <th>RoamingCalls</th>
      <th>PercChangeMinutes</th>
      <th>PercChangeRevenues</th>
      <th>ThreewayCalls</th>
      <th>ReceivedCalls</th>
      <th>OutboundCalls</th>
      <th>InboundCalls</th>
      <th>PeakCallsInOut</th>
      <th>OffPeakCallsInOut</th>
      <th>MonthsInService</th>
      <th>UniqueSubs</th>
      <th>ActiveSubs</th>
      <th>ServiceArea</th>
      <th>CreditRating</th>
      <th>IncomeGroup</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>24.00</td>
      <td>219.0</td>
      <td>22.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>-157.0</td>
      <td>-19.0</td>
      <td>0.0</td>
      <td>97.2</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>58.0</td>
      <td>24.0</td>
      <td>61</td>
      <td>2</td>
      <td>1</td>
      <td>658</td>
      <td>0</td>
      <td>4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>16.99</td>
      <td>10.0</td>
      <td>17.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>-4.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>58</td>
      <td>1</td>
      <td>1</td>
      <td>610</td>
      <td>3</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>38.00</td>
      <td>8.0</td>
      <td>38.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>-2.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.4</td>
      <td>0.3</td>
      <td>0.0</td>
      <td>1.3</td>
      <td>3.7</td>
      <td>60</td>
      <td>1</td>
      <td>1</td>
      <td>352</td>
      <td>2</td>
      <td>6</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>82.28</td>
      <td>1312.0</td>
      <td>75.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>157.0</td>
      <td>8.1</td>
      <td>1.3</td>
      <td>200.3</td>
      <td>370.3</td>
      <td>147.0</td>
      <td>555.7</td>
      <td>303.7</td>
      <td>59</td>
      <td>2</td>
      <td>2</td>
      <td>610</td>
      <td>3</td>
      <td>6</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>17.14</td>
      <td>0.0</td>
      <td>17.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>-0.2</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>53</td>
      <td>2</td>
      <td>2</td>
      <td>563</td>
      <td>0</td>
      <td>9</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-d145cd09-8c91-4ddb-94e3-fcb1469de02f')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-d145cd09-8c91-4ddb-94e3-fcb1469de02f button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-d145cd09-8c91-4ddb-94e3-fcb1469de02f');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-7a33e8b6-88e0-4340-a182-2972ccef24cb">
  <button class="colab-df-quickchart" onclick="quickchart('df-7a33e8b6-88e0-4340-a182-2972ccef24cb')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-7a33e8b6-88e0-4340-a182-2972ccef24cb button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="100"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="geUPZSghgP7i" data-outputId="3e640fe0-42b2-44aa-86c2-2b248fe0fc38">
<div class="sourceCode" id="cb72"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>df.shape</span></code></pre></div>
<div class="output execute_result" data-execution_count="100">
<pre><code>(49699, 20)</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="105"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="_Tttl6IMPlWY" data-outputId="64febe65-095e-4b42-de86-a8bd48961e53">
<div class="sourceCode" id="cb74"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_univariate_outliers(df):</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>    numerical_cols <span class="op">=</span> df.select_dtypes(include<span class="op">=</span>[<span class="st">&#39;float64&#39;</span>, <span class="st">&#39;int64&#39;</span>]).columns</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>    outlier_counts <span class="op">=</span> {}</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> col <span class="kw">in</span> numerical_cols:</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>        Q1 <span class="op">=</span> df[col].quantile(<span class="fl">0.25</span>)</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>        Q3 <span class="op">=</span> df[col].quantile(<span class="fl">0.75</span>)</span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>        IQR <span class="op">=</span> Q3 <span class="op">-</span> Q1</span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>        lower_bound <span class="op">=</span> Q1 <span class="op">-</span> <span class="fl">1.5</span> <span class="op">*</span> IQR</span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a>        upper_bound <span class="op">=</span> Q3 <span class="op">+</span> <span class="fl">1.5</span> <span class="op">*</span> IQR</span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>        outliers <span class="op">=</span> df[(df[col] <span class="op">&lt;</span> lower_bound) <span class="op">|</span> (df[col] <span class="op">&gt;</span> upper_bound)]</span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a>        outlier_counts[col] <span class="op">=</span> <span class="bu">len</span>(outliers)</span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> outlier_counts <span class="co">#The indentation of this line was corrected</span></span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd <span class="co"># Import the pandas library for dataframe operations</span></span>
<span id="cb74-15"><a href="#cb74-15" aria-hidden="true" tabindex="-1"></a>outlier_counts <span class="op">=</span> count_univariate_outliers(df)</span>
<span id="cb74-16"><a href="#cb74-16" aria-hidden="true" tabindex="-1"></a>outlier_df <span class="op">=</span> pd.DataFrame(outlier_counts.items(), columns<span class="op">=</span>[<span class="st">&#39;Column&#39;</span>, <span class="st">&#39;Outlier Count&#39;</span>])</span>
<span id="cb74-17"><a href="#cb74-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(outlier_df)</span>
<span id="cb74-18"><a href="#cb74-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Removed the repeated block of code that was causing the indentation error</span></span></code></pre></div>
<div class="output stream stdout">
<pre><code>                  Column  Outlier Count
0                  Churn              0
1         MonthlyRevenue           2909
2         MonthlyMinutes           2516
3   TotalRecurringCharge            796
4         AverageMinutes           5795
5           RoamingCalls           8612
6      PercChangeMinutes           6676
7     PercChangeRevenues          13011
8          ThreewayCalls           4486
9          ReceivedCalls           3542
10         OutboundCalls           3249
11          InboundCalls           4835
12        PeakCallsInOut           2756
13     OffPeakCallsInOut           3526
14       MonthsInService           1152
15            UniqueSubs           1790
16            ActiveSubs            564
17           ServiceArea              0
18          CreditRating              0
19           IncomeGroup              0
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="106"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:807}"
id="kxaT_6Qhdqb9" data-outputId="54d31b27-39df-41a4-8eaa-a445a6cd8787">
<div class="sourceCode" id="cb76"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">8</span>))</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>plt.barh(outlier_df[<span class="st">&#39;Column&#39;</span>], outlier_df[<span class="st">&#39;Outlier Count&#39;</span>], color<span class="op">=</span><span class="st">&#39;skyblue&#39;</span>)</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Outlier Count&#39;</span>)</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Column&#39;</span>)</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Outlier Counts by Column&#39;</span>)</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>plt.gca().invert_yaxis()</span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_5cdade6e6d334c1a8623e96f9dd6155b/29a713a7b1f51472fcae7dbbac76ceecaf0d35c8.png" /></p>
</div>
</div>
<div class="cell markdown" id="3-lsvGcPgeGD">
<p>The outlier count summary shows the number of data points in each
column that fall outside the expected range based on the Interquartile
Range (IQR) method. Columns with higher outlier counts, such as
PercChange Revenues (13,017) and Roaming Calls (8,616), have many values
that deviate significantly from the rest of the data. This indicates
unusual values or possible anomalies in these fields. In contrast, some
columns like AgeHH1, AgeHH2, and Income Group have zero outliers,
meaning their values are within the expected range without any extreme
deviations. This count helps identify columns that may need special
handling or transformation to manage outliers effectively in the
dataset.</p>
</div>
<div class="cell code" data-execution_count="107" id="AqeORT6Ipoai">
<div class="sourceCode" id="cb77"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> RobustScaler()</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>df_scaled <span class="op">=</span> scaler.fit_transform(df)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="108"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:226}"
id="ibe0bi_7psEL" data-outputId="0750d9be-6b12-4e02-d061-9a858ad48ce2">
<div class="sourceCode" id="cb78"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>df.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="108">

  <div id="df-ac2ea340-2174-44f7-a92f-b632bfe6965a" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Churn</th>
      <th>MonthlyRevenue</th>
      <th>MonthlyMinutes</th>
      <th>TotalRecurringCharge</th>
      <th>AverageMinutes</th>
      <th>RoamingCalls</th>
      <th>PercChangeMinutes</th>
      <th>PercChangeRevenues</th>
      <th>ThreewayCalls</th>
      <th>ReceivedCalls</th>
      <th>OutboundCalls</th>
      <th>InboundCalls</th>
      <th>PeakCallsInOut</th>
      <th>OffPeakCallsInOut</th>
      <th>MonthsInService</th>
      <th>UniqueSubs</th>
      <th>ActiveSubs</th>
      <th>ServiceArea</th>
      <th>CreditRating</th>
      <th>IncomeGroup</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>24.00</td>
      <td>219.0</td>
      <td>22.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>-157.0</td>
      <td>-19.0</td>
      <td>0.0</td>
      <td>97.2</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>58.0</td>
      <td>24.0</td>
      <td>61</td>
      <td>2</td>
      <td>1</td>
      <td>658</td>
      <td>0</td>
      <td>4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>16.99</td>
      <td>10.0</td>
      <td>17.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>-4.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>58</td>
      <td>1</td>
      <td>1</td>
      <td>610</td>
      <td>3</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>38.00</td>
      <td>8.0</td>
      <td>38.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>-2.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.4</td>
      <td>0.3</td>
      <td>0.0</td>
      <td>1.3</td>
      <td>3.7</td>
      <td>60</td>
      <td>1</td>
      <td>1</td>
      <td>352</td>
      <td>2</td>
      <td>6</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>82.28</td>
      <td>1312.0</td>
      <td>75.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>157.0</td>
      <td>8.1</td>
      <td>1.3</td>
      <td>200.3</td>
      <td>370.3</td>
      <td>147.0</td>
      <td>555.7</td>
      <td>303.7</td>
      <td>59</td>
      <td>2</td>
      <td>2</td>
      <td>610</td>
      <td>3</td>
      <td>6</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>17.14</td>
      <td>0.0</td>
      <td>17.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>-0.2</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>53</td>
      <td>2</td>
      <td>2</td>
      <td>563</td>
      <td>0</td>
      <td>9</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-ac2ea340-2174-44f7-a92f-b632bfe6965a')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-ac2ea340-2174-44f7-a92f-b632bfe6965a button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-ac2ea340-2174-44f7-a92f-b632bfe6965a');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-c8e355e6-faec-4603-8c55-76121d856754">
  <button class="colab-df-quickchart" onclick="quickchart('df-c8e355e6-faec-4603-8c55-76121d856754')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-c8e355e6-faec-4603-8c55-76121d856754 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="109" id="IhEYymq8rlw7">
<div class="sourceCode" id="cb79"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>numeric_cols <span class="op">=</span> df.select_dtypes(include<span class="op">=</span>[<span class="st">&#39;number&#39;</span>]).columns</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> RobustScaler()</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>df[numeric_cols] <span class="op">=</span> scaler.fit_transform(df[numeric_cols])</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>shifted_data <span class="op">=</span> df <span class="op">+</span> <span class="bu">abs</span>(df.<span class="bu">min</span>())</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>df[numeric_cols] <span class="op">=</span> shifted_data</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>df[numeric_cols] <span class="op">=</span> df[numeric_cols].<span class="bu">round</span>(<span class="dv">3</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="110"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:226}"
id="bScRLZB9rnIJ" data-outputId="3b8f5170-dfbb-4b69-c854-58b8af4c8b00">
<div class="sourceCode" id="cb80"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>df.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="110">

  <div id="df-f076df3b-2c1d-41c3-ac39-15f5287b3406" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Churn</th>
      <th>MonthlyRevenue</th>
      <th>MonthlyMinutes</th>
      <th>TotalRecurringCharge</th>
      <th>AverageMinutes</th>
      <th>RoamingCalls</th>
      <th>PercChangeMinutes</th>
      <th>PercChangeRevenues</th>
      <th>ThreewayCalls</th>
      <th>ReceivedCalls</th>
      <th>OutboundCalls</th>
      <th>InboundCalls</th>
      <th>PeakCallsInOut</th>
      <th>OffPeakCallsInOut</th>
      <th>MonthsInService</th>
      <th>UniqueSubs</th>
      <th>ActiveSubs</th>
      <th>ServiceArea</th>
      <th>CreditRating</th>
      <th>IncomeGroup</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>0.809</td>
      <td>0.389</td>
      <td>0.933</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>25.122</td>
      <td>126.593</td>
      <td>0.000</td>
      <td>0.670</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.594</td>
      <td>0.309</td>
      <td>4.231</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>2.022</td>
      <td>0.0</td>
      <td>0.667</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.0</td>
      <td>0.621</td>
      <td>0.018</td>
      <td>0.767</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>26.155</td>
      <td>128.802</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.051</td>
      <td>0.013</td>
      <td>4.000</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.874</td>
      <td>1.5</td>
      <td>0.833</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.0</td>
      <td>1.184</td>
      <td>0.014</td>
      <td>1.467</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>26.169</td>
      <td>128.802</td>
      <td>0.000</td>
      <td>0.003</td>
      <td>0.010</td>
      <td>0.000</td>
      <td>0.013</td>
      <td>0.048</td>
      <td>4.154</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.081</td>
      <td>1.0</td>
      <td>1.000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.0</td>
      <td>2.372</td>
      <td>2.328</td>
      <td>2.700</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>27.243</td>
      <td>129.744</td>
      <td>4.333</td>
      <td>1.381</td>
      <td>12.062</td>
      <td>15.806</td>
      <td>5.688</td>
      <td>3.909</td>
      <td>4.077</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>1.874</td>
      <td>1.5</td>
      <td>1.000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.0</td>
      <td>0.625</td>
      <td>0.000</td>
      <td>0.767</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>26.182</td>
      <td>128.779</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>3.615</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>1.730</td>
      <td>0.0</td>
      <td>1.500</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-f076df3b-2c1d-41c3-ac39-15f5287b3406')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-f076df3b-2c1d-41c3-ac39-15f5287b3406 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-f076df3b-2c1d-41c3-ac39-15f5287b3406');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-8615bfcb-2750-4496-a2e6-25b0108da232">
  <button class="colab-df-quickchart" onclick="quickchart('df-8615bfcb-2750-4496-a2e6-25b0108da232')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-8615bfcb-2750-4496-a2e6-25b0108da232 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="111"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="egvAIhtqtyy7" data-outputId="a4732234-181a-47b2-958e-ce89e09402d7">
<div class="sourceCode" id="cb81"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>correlation_matrix <span class="op">=</span> df.corr()</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(correlation_matrix)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>                         Churn  MonthlyRevenue  MonthlyMinutes  \
Churn                 1.000000       -0.012319       -0.050211   
MonthlyRevenue       -0.012319        1.000000        0.712320   
MonthlyMinutes       -0.050211        0.712320        1.000000   
TotalRecurringCharge -0.058885        0.630620        0.585851   
AverageMinutes        0.014931        0.787207        0.568798   
RoamingCalls          0.011005        0.304539        0.112155   
PercChangeMinutes    -0.033213       -0.026615       -0.044004   
PercChangeRevenues    0.013005       -0.013647       -0.038192   
ThreewayCalls        -0.023628        0.201036        0.287582   
ReceivedCalls        -0.037050        0.605532        0.828831   
OutboundCalls        -0.032293        0.495531        0.695008   
InboundCalls         -0.033800        0.373670        0.558501   
PeakCallsInOut       -0.039403        0.642509        0.772761   
OffPeakCallsInOut    -0.040799        0.473658        0.765479   
MonthsInService       0.017597        0.001042       -0.065791   
UniqueSubs            0.032862       -0.015119       -0.028926   
ActiveSubs            0.013061       -0.044586       -0.066410   
ServiceArea           0.003497        0.000363       -0.006169   
CreditRating         -0.047951        0.139246        0.206252   
IncomeGroup          -0.012768       -0.079400       -0.146124   

                      TotalRecurringCharge  AverageMinutes  RoamingCalls  \
Churn                            -0.058885        0.014931      0.011005   
MonthlyRevenue                    0.630620        0.787207      0.304539   
MonthlyMinutes                    0.585851        0.568798      0.112155   
TotalRecurringCharge              1.000000        0.202788      0.073938   
AverageMinutes                    0.202788        1.000000      0.063395   
RoamingCalls                      0.073938        0.063395      1.000000   
PercChangeMinutes                -0.016265       -0.025757     -0.054873   
PercChangeRevenues               -0.024154       -0.013742     -0.092836   
ThreewayCalls                     0.148230        0.164712      0.024152   
ReceivedCalls                     0.482079        0.516112      0.045132   
OutboundCalls                     0.410237        0.405862      0.045428   
InboundCalls                      0.307190        0.319115      0.020702   
PeakCallsInOut                    0.552864        0.519561      0.062587   
OffPeakCallsInOut                 0.369656        0.391996      0.031355   
MonthsInService                  -0.044939        0.002813     -0.009501   
UniqueSubs                       -0.020715       -0.003771     -0.002964   
ActiveSubs                       -0.058775       -0.014870     -0.002170   
ServiceArea                      -0.003028       -0.002982      0.001967   
CreditRating                      0.134737        0.080811      0.014918   
IncomeGroup                      -0.075341       -0.048250     -0.014271   

                      PercChangeMinutes  PercChangeRevenues  ThreewayCalls  \
Churn                         -0.033213            0.013005      -0.023628   
MonthlyRevenue                -0.026615           -0.013647       0.201036   
MonthlyMinutes                -0.044004           -0.038192       0.287582   
TotalRecurringCharge          -0.016265           -0.024154       0.148230   
AverageMinutes                -0.025757           -0.013742       0.164712   
RoamingCalls                  -0.054873           -0.092836       0.024152   
PercChangeMinutes              1.000000            0.607163      -0.028848   
PercChangeRevenues             0.607163            1.000000       0.014407   
ThreewayCalls                 -0.028848            0.014407       1.000000   
ReceivedCalls                 -0.106051           -0.077888       0.241453   
OutboundCalls                 -0.062340           -0.038613       0.218645   
InboundCalls                  -0.067804           -0.044335       0.164528   
PeakCallsInOut                -0.107936           -0.078200       0.254786   
OffPeakCallsInOut             -0.089296           -0.051322       0.312901   
MonthsInService                0.005581           -0.005790      -0.056058   
UniqueSubs                     0.002527            0.002591      -0.017558   
ActiveSubs                     0.010341            0.005790      -0.030821   
ServiceArea                    0.012083            0.005756      -0.015687   
CreditRating                  -0.033732           -0.021669       0.104306   
IncomeGroup                    0.012531            0.005434      -0.046114   

                      ReceivedCalls  OutboundCalls  InboundCalls  \
Churn                     -0.037050      -0.032293     -0.033800   
MonthlyRevenue             0.605532       0.495531      0.373670   
MonthlyMinutes             0.828831       0.695008      0.558501   
TotalRecurringCharge       0.482079       0.410237      0.307190   
AverageMinutes             0.516112       0.405862      0.319115   
RoamingCalls               0.045132       0.045428      0.020702   
PercChangeMinutes         -0.106051      -0.062340     -0.067804   
PercChangeRevenues        -0.077888      -0.038613     -0.044335   
ThreewayCalls              0.241453       0.218645      0.164528   
ReceivedCalls              1.000000       0.652491      0.618121   
OutboundCalls              0.652491       1.000000      0.725701   
InboundCalls               0.618121       0.725701      1.000000   
PeakCallsInOut             0.746766       0.710244      0.595420   
OffPeakCallsInOut          0.737769       0.741762      0.654193   
MonthsInService           -0.019010      -0.022798     -0.012515   
UniqueSubs                -0.020076       0.016028      0.046170   
ActiveSubs                -0.047156       0.011381      0.068681   
ServiceArea                0.000204       0.000126      0.016407   
CreditRating               0.200825       0.161368      0.140220   
IncomeGroup               -0.132145      -0.103606     -0.102007   

                      PeakCallsInOut  OffPeakCallsInOut  MonthsInService  \
Churn                      -0.039403          -0.040799         0.017597   
MonthlyRevenue              0.642509           0.473658         0.001042   
MonthlyMinutes              0.772761           0.765479        -0.065791   
TotalRecurringCharge        0.552864           0.369656        -0.044939   
AverageMinutes              0.519561           0.391996         0.002813   
RoamingCalls                0.062587           0.031355        -0.009501   
PercChangeMinutes          -0.107936          -0.089296         0.005581   
PercChangeRevenues         -0.078200          -0.051322        -0.005790   
ThreewayCalls               0.254786           0.312901        -0.056058   
ReceivedCalls               0.746766           0.737769        -0.019010   
OutboundCalls               0.710244           0.741762        -0.022798   
InboundCalls                0.595420           0.654193        -0.012515   
PeakCallsInOut              1.000000           0.698974         0.044925   
OffPeakCallsInOut           0.698974           1.000000        -0.094373   
MonthsInService             0.044925          -0.094373         1.000000   
UniqueSubs                  0.005220          -0.033486         0.014826   
ActiveSubs                 -0.008745          -0.063741         0.029631   
ServiceArea                 0.005796           0.001686         0.060622   
CreditRating                0.168544           0.251421        -0.249156   
IncomeGroup                -0.087016          -0.145488         0.138719   

                      UniqueSubs  ActiveSubs  ServiceArea  CreditRating  \
Churn                   0.032862    0.013061     0.003497     -0.047951   
MonthlyRevenue         -0.015119   -0.044586     0.000363      0.139246   
MonthlyMinutes         -0.028926   -0.066410    -0.006169      0.206252   
TotalRecurringCharge   -0.020715   -0.058775    -0.003028      0.134737   
AverageMinutes         -0.003771   -0.014870    -0.002982      0.080811   
RoamingCalls           -0.002964   -0.002170     0.001967      0.014918   
PercChangeMinutes       0.002527    0.010341     0.012083     -0.033732   
PercChangeRevenues      0.002591    0.005790     0.005756     -0.021669   
ThreewayCalls          -0.017558   -0.030821    -0.015687      0.104306   
ReceivedCalls          -0.020076   -0.047156     0.000204      0.200825   
OutboundCalls           0.016028    0.011381     0.000126      0.161368   
InboundCalls            0.046170    0.068681     0.016407      0.140220   
PeakCallsInOut          0.005220   -0.008745     0.005796      0.168544   
OffPeakCallsInOut      -0.033486   -0.063741     0.001686      0.251421   
MonthsInService         0.014826    0.029631     0.060622     -0.249156   
UniqueSubs              1.000000    0.773977     0.010516     -0.144058   
ActiveSubs              0.773977    1.000000     0.006600     -0.205554   
ServiceArea             0.010516    0.006600     1.000000      0.005078   
CreditRating           -0.144058   -0.205554     0.005078      1.000000   
IncomeGroup             0.052550    0.116900    -0.019690     -0.269272   

                      IncomeGroup  
Churn                   -0.012768  
MonthlyRevenue          -0.079400  
MonthlyMinutes          -0.146124  
TotalRecurringCharge    -0.075341  
AverageMinutes          -0.048250  
RoamingCalls            -0.014271  
PercChangeMinutes        0.012531  
PercChangeRevenues       0.005434  
ThreewayCalls           -0.046114  
ReceivedCalls           -0.132145  
OutboundCalls           -0.103606  
InboundCalls            -0.102007  
PeakCallsInOut          -0.087016  
OffPeakCallsInOut       -0.145488  
MonthsInService          0.138719  
UniqueSubs               0.052550  
ActiveSubs               0.116900  
ServiceArea             -0.019690  
CreditRating            -0.269272  
IncomeGroup              1.000000  
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="113"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="p8ZJjqWbu2P9" data-outputId="851a8394-b3f6-43d1-995d-bb2c859363c6">
<div class="sourceCode" id="cb83"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>correlation_matrix <span class="op">=</span> df.corr()</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>independent_pairs <span class="op">=</span> []</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(correlation_matrix.columns)):</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i):</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">abs</span>(correlation_matrix.iloc[i, j]) <span class="op">&lt;</span> <span class="fl">0.1</span>:</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>            independent_pairs.append((</span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>                correlation_matrix.columns[i],</span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>                correlation_matrix.columns[j],</span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a>                correlation_matrix.iloc[i, j]</span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a>            ))</span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a>independent_pairs</span></code></pre></div>
<div class="output execute_result" data-execution_count="113">
<pre><code>[(&#39;MonthlyRevenue&#39;, &#39;Churn&#39;, -0.01231949366025343),
 (&#39;MonthlyMinutes&#39;, &#39;Churn&#39;, -0.05021051480776981),
 (&#39;TotalRecurringCharge&#39;, &#39;Churn&#39;, -0.058884629657147),
 (&#39;AverageMinutes&#39;, &#39;Churn&#39;, 0.014930944426988073),
 (&#39;RoamingCalls&#39;, &#39;Churn&#39;, 0.011004603894373983),
 (&#39;RoamingCalls&#39;, &#39;TotalRecurringCharge&#39;, 0.07393839617411464),
 (&#39;RoamingCalls&#39;, &#39;AverageMinutes&#39;, 0.06339474523792833),
 (&#39;PercChangeMinutes&#39;, &#39;Churn&#39;, -0.03321277803992057),
 (&#39;PercChangeMinutes&#39;, &#39;MonthlyRevenue&#39;, -0.02661459118132551),
 (&#39;PercChangeMinutes&#39;, &#39;MonthlyMinutes&#39;, -0.04400361058663566),
 (&#39;PercChangeMinutes&#39;, &#39;TotalRecurringCharge&#39;, -0.01626504867647658),
 (&#39;PercChangeMinutes&#39;, &#39;AverageMinutes&#39;, -0.02575724673244575),
 (&#39;PercChangeMinutes&#39;, &#39;RoamingCalls&#39;, -0.05487323016224774),
 (&#39;PercChangeRevenues&#39;, &#39;Churn&#39;, 0.01300514212382899),
 (&#39;PercChangeRevenues&#39;, &#39;MonthlyRevenue&#39;, -0.013646868663946349),
 (&#39;PercChangeRevenues&#39;, &#39;MonthlyMinutes&#39;, -0.03819182682876094),
 (&#39;PercChangeRevenues&#39;, &#39;TotalRecurringCharge&#39;, -0.02415421409636574),
 (&#39;PercChangeRevenues&#39;, &#39;AverageMinutes&#39;, -0.013742007800971533),
 (&#39;PercChangeRevenues&#39;, &#39;RoamingCalls&#39;, -0.09283569406488301),
 (&#39;ThreewayCalls&#39;, &#39;Churn&#39;, -0.02362767955252888),
 (&#39;ThreewayCalls&#39;, &#39;RoamingCalls&#39;, 0.024151917618756263),
 (&#39;ThreewayCalls&#39;, &#39;PercChangeMinutes&#39;, -0.02884796946624521),
 (&#39;ThreewayCalls&#39;, &#39;PercChangeRevenues&#39;, 0.014407330824690067),
 (&#39;ReceivedCalls&#39;, &#39;Churn&#39;, -0.03704988330268507),
 (&#39;ReceivedCalls&#39;, &#39;RoamingCalls&#39;, 0.04513174509994459),
 (&#39;ReceivedCalls&#39;, &#39;PercChangeRevenues&#39;, -0.07788812447078),
 (&#39;OutboundCalls&#39;, &#39;Churn&#39;, -0.03229262993412989),
 (&#39;OutboundCalls&#39;, &#39;RoamingCalls&#39;, 0.0454276384236655),
 (&#39;OutboundCalls&#39;, &#39;PercChangeMinutes&#39;, -0.062340263240449105),
 (&#39;OutboundCalls&#39;, &#39;PercChangeRevenues&#39;, -0.03861345773444675),
 (&#39;InboundCalls&#39;, &#39;Churn&#39;, -0.03379996468925643),
 (&#39;InboundCalls&#39;, &#39;RoamingCalls&#39;, 0.02070234281340666),
 (&#39;InboundCalls&#39;, &#39;PercChangeMinutes&#39;, -0.0678038021304938),
 (&#39;InboundCalls&#39;, &#39;PercChangeRevenues&#39;, -0.04433520009589065),
 (&#39;PeakCallsInOut&#39;, &#39;Churn&#39;, -0.03940330609940013),
 (&#39;PeakCallsInOut&#39;, &#39;RoamingCalls&#39;, 0.06258674620852266),
 (&#39;PeakCallsInOut&#39;, &#39;PercChangeRevenues&#39;, -0.07819954449273203),
 (&#39;OffPeakCallsInOut&#39;, &#39;Churn&#39;, -0.040799366459338744),
 (&#39;OffPeakCallsInOut&#39;, &#39;RoamingCalls&#39;, 0.031354558930777036),
 (&#39;OffPeakCallsInOut&#39;, &#39;PercChangeMinutes&#39;, -0.0892955225398456),
 (&#39;OffPeakCallsInOut&#39;, &#39;PercChangeRevenues&#39;, -0.051322077579685696),
 (&#39;MonthsInService&#39;, &#39;Churn&#39;, 0.017596533556110346),
 (&#39;MonthsInService&#39;, &#39;MonthlyRevenue&#39;, 0.0010418874221429415),
 (&#39;MonthsInService&#39;, &#39;MonthlyMinutes&#39;, -0.06579051160454921),
 (&#39;MonthsInService&#39;, &#39;TotalRecurringCharge&#39;, -0.04493916497179969),
 (&#39;MonthsInService&#39;, &#39;AverageMinutes&#39;, 0.002812597065537476),
 (&#39;MonthsInService&#39;, &#39;RoamingCalls&#39;, -0.0095009273415533),
 (&#39;MonthsInService&#39;, &#39;PercChangeMinutes&#39;, 0.005581467193016336),
 (&#39;MonthsInService&#39;, &#39;PercChangeRevenues&#39;, -0.005790212915905331),
 (&#39;MonthsInService&#39;, &#39;ThreewayCalls&#39;, -0.05605757899765856),
 (&#39;MonthsInService&#39;, &#39;ReceivedCalls&#39;, -0.019010032688391267),
 (&#39;MonthsInService&#39;, &#39;OutboundCalls&#39;, -0.022797844475776954),
 (&#39;MonthsInService&#39;, &#39;InboundCalls&#39;, -0.012515494147872777),
 (&#39;MonthsInService&#39;, &#39;PeakCallsInOut&#39;, 0.0449249369143876),
 (&#39;MonthsInService&#39;, &#39;OffPeakCallsInOut&#39;, -0.09437265824650534),
 (&#39;UniqueSubs&#39;, &#39;Churn&#39;, 0.032861570504282366),
 (&#39;UniqueSubs&#39;, &#39;MonthlyRevenue&#39;, -0.015118932466260322),
 (&#39;UniqueSubs&#39;, &#39;MonthlyMinutes&#39;, -0.028926164239157413),
 (&#39;UniqueSubs&#39;, &#39;TotalRecurringCharge&#39;, -0.020714821644249447),
 (&#39;UniqueSubs&#39;, &#39;AverageMinutes&#39;, -0.0037713655342926193),
 (&#39;UniqueSubs&#39;, &#39;RoamingCalls&#39;, -0.0029638216448149117),
 (&#39;UniqueSubs&#39;, &#39;PercChangeMinutes&#39;, 0.0025273935125254467),
 (&#39;UniqueSubs&#39;, &#39;PercChangeRevenues&#39;, 0.0025907232368158786),
 (&#39;UniqueSubs&#39;, &#39;ThreewayCalls&#39;, -0.01755844473345756),
 (&#39;UniqueSubs&#39;, &#39;ReceivedCalls&#39;, -0.020076027331228232),
 (&#39;UniqueSubs&#39;, &#39;OutboundCalls&#39;, 0.016027680083599966),
 (&#39;UniqueSubs&#39;, &#39;InboundCalls&#39;, 0.04616993687816893),
 (&#39;UniqueSubs&#39;, &#39;PeakCallsInOut&#39;, 0.005220322309699915),
 (&#39;UniqueSubs&#39;, &#39;OffPeakCallsInOut&#39;, -0.03348605364598412),
 (&#39;UniqueSubs&#39;, &#39;MonthsInService&#39;, 0.014826151510045675),
 (&#39;ActiveSubs&#39;, &#39;Churn&#39;, 0.013061335577815053),
 (&#39;ActiveSubs&#39;, &#39;MonthlyRevenue&#39;, -0.04458633501295451),
 (&#39;ActiveSubs&#39;, &#39;MonthlyMinutes&#39;, -0.06640999766967387),
 (&#39;ActiveSubs&#39;, &#39;TotalRecurringCharge&#39;, -0.058774604386694546),
 (&#39;ActiveSubs&#39;, &#39;AverageMinutes&#39;, -0.01487024248860157),
 (&#39;ActiveSubs&#39;, &#39;RoamingCalls&#39;, -0.002170115360288945),
 (&#39;ActiveSubs&#39;, &#39;PercChangeMinutes&#39;, 0.01034104718487878),
 (&#39;ActiveSubs&#39;, &#39;PercChangeRevenues&#39;, 0.005790017070562682),
 (&#39;ActiveSubs&#39;, &#39;ThreewayCalls&#39;, -0.030821039924800373),
 (&#39;ActiveSubs&#39;, &#39;ReceivedCalls&#39;, -0.04715579277608649),
 (&#39;ActiveSubs&#39;, &#39;OutboundCalls&#39;, 0.011380995059023154),
 (&#39;ActiveSubs&#39;, &#39;InboundCalls&#39;, 0.06868129304289927),
 (&#39;ActiveSubs&#39;, &#39;PeakCallsInOut&#39;, -0.008744711574764474),
 (&#39;ActiveSubs&#39;, &#39;OffPeakCallsInOut&#39;, -0.06374112269427762),
 (&#39;ActiveSubs&#39;, &#39;MonthsInService&#39;, 0.029631298776224054),
 (&#39;ServiceArea&#39;, &#39;Churn&#39;, 0.0034967287367044654),
 (&#39;ServiceArea&#39;, &#39;MonthlyRevenue&#39;, 0.00036330346609772323),
 (&#39;ServiceArea&#39;, &#39;MonthlyMinutes&#39;, -0.006168604831752565),
 (&#39;ServiceArea&#39;, &#39;TotalRecurringCharge&#39;, -0.0030283657116024014),
 (&#39;ServiceArea&#39;, &#39;AverageMinutes&#39;, -0.002981775521433097),
 (&#39;ServiceArea&#39;, &#39;RoamingCalls&#39;, 0.0019672558931468245),
 (&#39;ServiceArea&#39;, &#39;PercChangeMinutes&#39;, 0.012083009471521237),
 (&#39;ServiceArea&#39;, &#39;PercChangeRevenues&#39;, 0.005756386470848258),
 (&#39;ServiceArea&#39;, &#39;ThreewayCalls&#39;, -0.01568715332362156),
 (&#39;ServiceArea&#39;, &#39;ReceivedCalls&#39;, 0.00020409159132254382),
 (&#39;ServiceArea&#39;, &#39;OutboundCalls&#39;, 0.0001260655407108665),
 (&#39;ServiceArea&#39;, &#39;InboundCalls&#39;, 0.016406878383054494),
 (&#39;ServiceArea&#39;, &#39;PeakCallsInOut&#39;, 0.005796350913063477),
 (&#39;ServiceArea&#39;, &#39;OffPeakCallsInOut&#39;, 0.0016861277879361056),
 (&#39;ServiceArea&#39;, &#39;MonthsInService&#39;, 0.0606221788053814),
 (&#39;ServiceArea&#39;, &#39;UniqueSubs&#39;, 0.010515568654313742),
 (&#39;ServiceArea&#39;, &#39;ActiveSubs&#39;, 0.006599662477925098),
 (&#39;CreditRating&#39;, &#39;Churn&#39;, -0.047951288749643856),
 (&#39;CreditRating&#39;, &#39;AverageMinutes&#39;, 0.08081127153005932),
 (&#39;CreditRating&#39;, &#39;RoamingCalls&#39;, 0.01491793383324859),
 (&#39;CreditRating&#39;, &#39;PercChangeMinutes&#39;, -0.0337321995657127),
 (&#39;CreditRating&#39;, &#39;PercChangeRevenues&#39;, -0.0216689111595793),
 (&#39;CreditRating&#39;, &#39;ServiceArea&#39;, 0.005077684169872108),
 (&#39;IncomeGroup&#39;, &#39;Churn&#39;, -0.012767829863600758),
 (&#39;IncomeGroup&#39;, &#39;MonthlyRevenue&#39;, -0.07939952812179518),
 (&#39;IncomeGroup&#39;, &#39;TotalRecurringCharge&#39;, -0.07534112338710476),
 (&#39;IncomeGroup&#39;, &#39;AverageMinutes&#39;, -0.04824996394220254),
 (&#39;IncomeGroup&#39;, &#39;RoamingCalls&#39;, -0.014271211991667213),
 (&#39;IncomeGroup&#39;, &#39;PercChangeMinutes&#39;, 0.012530913122867767),
 (&#39;IncomeGroup&#39;, &#39;PercChangeRevenues&#39;, 0.005433950591954624),
 (&#39;IncomeGroup&#39;, &#39;ThreewayCalls&#39;, -0.04611445992614163),
 (&#39;IncomeGroup&#39;, &#39;PeakCallsInOut&#39;, -0.0870159091606753),
 (&#39;IncomeGroup&#39;, &#39;UniqueSubs&#39;, 0.05254956476163352),
 (&#39;IncomeGroup&#39;, &#39;ServiceArea&#39;, -0.019689968841486365)]</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="114"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="jeQENzgvvTJh" data-outputId="cb5a6daf-6490-4380-94de-989fce02a645">
<div class="sourceCode" id="cb85"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> df.drop(<span class="st">&#39;Churn&#39;</span>, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df[<span class="st">&#39;Churn&#39;</span>]</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> StandardScaler()</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>X_scaled <span class="op">=</span> scaler.fit_transform(X)</span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>lasso <span class="op">=</span> Lasso(alpha<span class="op">=</span><span class="fl">0.01</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>lasso.fit(X_scaled, y)</span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>selected_features <span class="op">=</span> X.columns[(lasso.coef_ <span class="op">!=</span> <span class="dv">0</span>)]</span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Selected Features:&quot;</span>)</span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(selected_features)</span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a>X_selected <span class="op">=</span> df[selected_features]</span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a>X_selected.to_csv(<span class="st">&#39;selected_features.csv&#39;</span>, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb85-12"><a href="#cb85-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Lasso Coefficients:&quot;</span>)</span>
<span id="cb85-13"><a href="#cb85-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(lasso.coef_)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Selected Features:
Index([&#39;MonthlyMinutes&#39;, &#39;TotalRecurringCharge&#39;, &#39;AverageMinutes&#39;,
       &#39;PercChangeMinutes&#39;, &#39;UniqueSubs&#39;, &#39;CreditRating&#39;],
      dtype=&#39;object&#39;)

Lasso Coefficients:
[ 0.         -0.00492926 -0.01313533  0.00279863  0.         -0.00568055
  0.         -0.         -0.         -0.         -0.         -0.
 -0.          0.          0.003192    0.          0.         -0.00885022
 -0.        ]
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="115"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:609}"
id="KtdWcivb7Z8e" data-outputId="0fa24498-98f7-42e5-8733-e5c0f1bb5a67">
<div class="sourceCode" id="cb87"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>class_counts <span class="op">=</span> df[<span class="st">&#39;Churn&#39;</span>].value_counts()</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Class Counts:</span><span class="ch">\n</span><span class="st">&quot;</span>, class_counts)</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">6</span>, <span class="dv">4</span>))</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>sns.barplot(x<span class="op">=</span>class_counts.index, y<span class="op">=</span>class_counts.values, palette<span class="op">=</span><span class="st">&#39;viridis&#39;</span>)</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Churn (0 = Not Churn, 1 = Churn)&#39;</span>)</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Count&#39;</span>)</span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Class Distribution (Churn vs. Not Churn)&#39;</span>)</span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>plt.xticks([<span class="dv">0</span>, <span class="dv">1</span>], [<span class="st">&#39;Not Churn&#39;</span>, <span class="st">&#39;Churn&#39;</span>])</span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Class Counts:
 Churn
0.0    35463
1.0    14236
Name: count, dtype: int64
</code></pre>
</div>
<div class="output stream stderr">
<pre><code>&lt;ipython-input-115-7d9a43e8d6d1&gt;:6: FutureWarning: 

Passing `palette` without assigning `hue` is deprecated and will be removed in v0.14.0. Assign the `x` variable to `hue` and set `legend=False` for the same effect.

  sns.barplot(x=class_counts.index, y=class_counts.values, palette=&#39;viridis&#39;)
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_5cdade6e6d334c1a8623e96f9dd6155b/8db13d7a7196620e91880d0c96cabe0525bd609d.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="116"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="k2rwooo-8Bkh" data-outputId="8a4fdacf-50a6-4015-f7e9-65b75027dd0e">
<div class="sourceCode" id="cb90"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> df.drop(<span class="st">&#39;Churn&#39;</span>, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df[<span class="st">&#39;Churn&#39;</span>]</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.3</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>smote <span class="op">=</span> SMOTE(random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>X_train_resampled, y_train_resampled <span class="op">=</span> smote.fit_resample(X_train, y_train)</span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Before SMOTE:&quot;</span>)</span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(y_train.value_counts())</span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">After SMOTE:&quot;</span>)</span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(pd.Series(y_train_resampled).value_counts())</span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> RandomForestClassifier(random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb90-13"><a href="#cb90-13" aria-hidden="true" tabindex="-1"></a>model.fit(X_train_resampled, y_train_resampled)</span>
<span id="cb90-14"><a href="#cb90-14" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> model.predict(X_test)</span>
<span id="cb90-15"><a href="#cb90-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Classification Report:&quot;</span>)</span>
<span id="cb90-16"><a href="#cb90-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y_test, y_pred))</span>
<span id="cb90-17"><a href="#cb90-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Accuracy: </span><span class="sc">{</span>accuracy_score(y_test, y_pred)<span class="sc">:.3f}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Before SMOTE:
Churn
0.0    24742
1.0    10047
Name: count, dtype: int64

After SMOTE:
Churn
1.0    24742
0.0    24742
Name: count, dtype: int64

Classification Report:
              precision    recall  f1-score   support

         0.0       0.75      0.88      0.81     10721
         1.0       0.43      0.24      0.31      4189

    accuracy                           0.70     14910
   macro avg       0.59      0.56      0.56     14910
weighted avg       0.66      0.70      0.67     14910

Accuracy: 0.698
</code></pre>
</div>
</div>
<div class="cell markdown" id="OOPqwjYtk4SV">
<p>Random Forrest with SMOTE</p>
<p>Precision: Churn = No (0.0): 0.74 Churn = Yes (1.0): 0.42</p>
<p>Recall: Churn = No (0.0): 0.87 Churn = Yes (1.0): 0.24</p>
<p>F1-score: Churn = No (0.0): 0.80 Churn = Yes (1.0): 0.30</p>
<p>Accuracy:0.69</p>
<p>This model achieved a good recall for non-churned customers (0.87)
but performed lower on churned customers (recall of 0.24), indicating
that it better identified customers likely to stay than those likely to
leave.</p>
</div>
<div class="cell code" data-execution_count="117"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="oSO235hcJkrp" data-outputId="6bc6c79e-027d-42b3-bbfe-206867859d9f">
<div class="sourceCode" id="cb92"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> df.drop(<span class="st">&#39;Churn&#39;</span>, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df[<span class="st">&#39;Churn&#39;</span>]</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.3</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>smote <span class="op">=</span> SMOTE(random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>X_train_resampled, y_train_resampled <span class="op">=</span> smote.fit_resample(X_train, y_train)</span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Before SMOTE:&quot;</span>)</span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(y_train.value_counts())</span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">After SMOTE:&quot;</span>)</span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(pd.Series(y_train_resampled).value_counts())</span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> RandomForestClassifier(class_weight<span class="op">=</span><span class="st">&#39;balanced&#39;</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb92-11"><a href="#cb92-11" aria-hidden="true" tabindex="-1"></a>model.fit(X_train_resampled, y_train_resampled)</span>
<span id="cb92-12"><a href="#cb92-12" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> model.predict(X_test)</span>
<span id="cb92-13"><a href="#cb92-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Classification Report:&quot;</span>)</span>
<span id="cb92-14"><a href="#cb92-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y_test, y_pred))</span>
<span id="cb92-15"><a href="#cb92-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Accuracy: </span><span class="sc">{</span>accuracy_score(y_test, y_pred)<span class="sc">:.3f}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Before SMOTE:
Churn
0.0    24742
1.0    10047
Name: count, dtype: int64

After SMOTE:
Churn
1.0    24742
0.0    24742
Name: count, dtype: int64

Classification Report:
              precision    recall  f1-score   support

         0.0       0.75      0.88      0.81     10721
         1.0       0.43      0.24      0.31      4189

    accuracy                           0.70     14910
   macro avg       0.59      0.56      0.56     14910
weighted avg       0.66      0.70      0.67     14910

Accuracy: 0.698
</code></pre>
</div>
</div>
<div class="cell markdown" id="d9ye0ceQlLhv">
<p>Random Forest with Class Weights Balanced</p>
<p>Precision: Churn = No (0.0): 0.74 Churn = Yes (1.0): 0.42</p>
<p>Recall: Churn = No (0.0): 0.87 Churn = Yes (1.0): 0.24</p>
<p>F1-score: Churn = No (0.0): 0.80 Churn = Yes (1.0): 0.30</p>
<p>Accuracy: 0.69</p>
<p>The performance was identical to Random Forest with SMOTE, showing
that class weighting did not improve recall for churned customers.</p>
</div>
<div class="cell code" data-execution_count="120"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="CzyCHw6ZD2PJ" data-outputId="b63370c8-0f58-42dd-d1cd-3ca820292fb8">
<div class="sourceCode" id="cb94"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> df.drop(<span class="st">&#39;Churn&#39;</span>, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df[<span class="st">&#39;Churn&#39;</span>]</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.3</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>smote <span class="op">=</span> SMOTE(random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>X_train_resampled, y_train_resampled <span class="op">=</span> smote.fit_resample(X_train, y_train)</span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Class distribution after SMOTE:&quot;</span>, y_train_resampled.value_counts())</span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> LogisticRegression(max_iter<span class="op">=</span><span class="dv">1000</span>)</span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a>model.fit(X_train_resampled, y_train_resampled)</span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> model.predict(X_test)</span>
<span id="cb94-11"><a href="#cb94-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Confusion Matrix:&quot;</span>)</span>
<span id="cb94-12"><a href="#cb94-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(confusion_matrix(y_test, y_pred))</span>
<span id="cb94-13"><a href="#cb94-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Classification Report:&quot;</span>)</span>
<span id="cb94-14"><a href="#cb94-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y_test, y_pred))</span>
<span id="cb94-15"><a href="#cb94-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;</span><span class="ch">\n</span><span class="ss">Accuracy: </span><span class="sc">{</span>accuracy_score(y_test, y_pred)<span class="sc">:.3f}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Class distribution after SMOTE: Churn
1.0    24742
0.0    24742
Name: count, dtype: int64
Confusion Matrix:
[[5391 5330]
 [1649 2540]]

Classification Report:
              precision    recall  f1-score   support

         0.0       0.77      0.50      0.61     10721
         1.0       0.32      0.61      0.42      4189

    accuracy                           0.53     14910
   macro avg       0.54      0.55      0.51     14910
weighted avg       0.64      0.53      0.55     14910


Accuracy: 0.532
</code></pre>
</div>
</div>
<div class="cell markdown" id="w2M8jH6Xlf6Z">
<p>Logistic Regression with SMOTE</p>
<p>Precision: Churn = No (0.0): 0.76 Churn = Yes (1.0): 0.32</p>
<p>Recall: Churn = No (0.0): 0.49 Churn = Yes (1.0): 0.61</p>
<p>F1-score: Churn = No (0.0): 0.60 Churn = Yes (1.0): 0.42</p>
<p>Accuracy:0.53</p>
<p>Logistic regression with SMOTE achieved a much higher recall for
churned customers (0.61), but the overall accuracy was lower at 0.53.
This model prioritizes identifying churners, albeit with a trade-off in
accuracy.</p>
</div>
<div class="cell code" data-execution_count="122"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="SiY3f0DbQbuK" data-outputId="d57d2fc8-7c84-444f-d0d6-c569ac77b98b">
<div class="sourceCode" id="cb96"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> df.drop(<span class="st">&#39;Churn&#39;</span>, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df[<span class="st">&#39;Churn&#39;</span>]</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.3</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>smote <span class="op">=</span> SMOTE(random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>X_train_resampled, y_train_resampled <span class="op">=</span> smote.fit_resample(X_train, y_train)</span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Class distribution after SMOTE:&quot;</span>, y_train_resampled.value_counts())</span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> XGBClassifier(use_label_encoder<span class="op">=</span><span class="va">False</span>, eval_metric<span class="op">=</span><span class="st">&#39;logloss&#39;</span>)</span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a>model.fit(X_train_resampled, y_train_resampled)</span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> model.predict(X_test)</span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Confusion Matrix:&quot;</span>)</span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(confusion_matrix(y_test, y_pred))</span>
<span id="cb96-12"><a href="#cb96-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Classification Report:&quot;</span>)</span>
<span id="cb96-13"><a href="#cb96-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y_test, y_pred))</span>
<span id="cb96-14"><a href="#cb96-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;</span><span class="ch">\n</span><span class="ss">Accuracy: </span><span class="sc">{</span>accuracy_score(y_test, y_pred)<span class="sc">:.3f}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Class distribution after SMOTE: Churn
1.0    24742
0.0    24742
Name: count, dtype: int64
</code></pre>
</div>
<div class="output stream stderr">
<pre><code>/usr/local/lib/python3.10/dist-packages/xgboost/core.py:158: UserWarning: [05:51:37] WARNING: /workspace/src/learner.cc:740: 
Parameters: { &quot;use_label_encoder&quot; } are not used.

  warnings.warn(smsg, UserWarning)
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>Confusion Matrix:
[[9655 1066]
 [3308  881]]

Classification Report:
              precision    recall  f1-score   support

         0.0       0.74      0.90      0.82     10721
         1.0       0.45      0.21      0.29      4189

    accuracy                           0.71     14910
   macro avg       0.60      0.56      0.55     14910
weighted avg       0.66      0.71      0.67     14910


Accuracy: 0.707
</code></pre>
</div>
</div>
<div class="cell markdown" id="G0zpxF22lusE">
<p>XGBoost model</p>
<p>Precision: Churn = No (0.0): 0.74 Churn = Yes (1.0): 0.45</p>
<p>Recall: Churn = No (0.0): 0.90 Churn = Yes (1.0): 0.21</p>
<p>F1-score: Churn = No (0.0): 0.82 Churn = Yes (1.0): 0.29</p>
<p>Accuracy: 0.71</p>
<p>XGBoost performed well in identifying non-churned customers (recall
of 0.90), but it struggled with identifying churned customers, with a
low recall of 0.21.</p>
</div>
<div class="cell code" data-execution_count="121"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="QlGeshtoGt5R" data-outputId="d6b6741b-9e9b-4a50-b433-dccb899acc1e">
<div class="sourceCode" id="cb100"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> df.drop(<span class="st">&#39;Churn&#39;</span>, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df[<span class="st">&#39;Churn&#39;</span>]</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.3</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>smote <span class="op">=</span> SMOTE(random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>X_train_resampled, y_train_resampled <span class="op">=</span> smote.fit_resample(X_train, y_train)</span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>lgbm_model <span class="op">=</span> LGBMClassifier(</span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a>    n_estimators<span class="op">=</span><span class="dv">100</span>,</span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a>    max_depth<span class="op">=</span><span class="dv">5</span>,</span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true" tabindex="-1"></a>    learning_rate<span class="op">=</span><span class="fl">0.1</span>,</span>
<span id="cb100-10"><a href="#cb100-10" aria-hidden="true" tabindex="-1"></a>    class_weight<span class="op">=</span><span class="st">&#39;balanced&#39;</span>,</span>
<span id="cb100-11"><a href="#cb100-11" aria-hidden="true" tabindex="-1"></a>    subsample<span class="op">=</span><span class="fl">0.8</span>,</span>
<span id="cb100-12"><a href="#cb100-12" aria-hidden="true" tabindex="-1"></a>    colsample_bytree<span class="op">=</span><span class="fl">0.8</span>,</span>
<span id="cb100-13"><a href="#cb100-13" aria-hidden="true" tabindex="-1"></a>    random_state<span class="op">=</span><span class="dv">42</span></span>
<span id="cb100-14"><a href="#cb100-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb100-15"><a href="#cb100-15" aria-hidden="true" tabindex="-1"></a>lgbm_model.fit(X_train_resampled, y_train_resampled)</span>
<span id="cb100-16"><a href="#cb100-16" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> lgbm_model.predict(X_test)</span>
<span id="cb100-17"><a href="#cb100-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Confusion Matrix:&quot;</span>)</span>
<span id="cb100-18"><a href="#cb100-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(confusion_matrix(y_test, y_pred))</span>
<span id="cb100-19"><a href="#cb100-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Classification Report:&quot;</span>)</span>
<span id="cb100-20"><a href="#cb100-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y_test, y_pred))</span>
<span id="cb100-21"><a href="#cb100-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;</span><span class="ch">\n</span><span class="ss">Accuracy: </span><span class="sc">{</span>accuracy_score(y_test, y_pred)<span class="sc">:.3f}</span><span class="ss">&quot;</span></span></code></pre></div>
<div class="output stream stdout">
<pre><code>[LightGBM] [Info] Number of positive: 24742, number of negative: 24742
[LightGBM] [Info] Auto-choosing row-wise multi-threading, the overhead of testing was 0.005815 seconds.
You can set `force_row_wise=true` to remove the overhead.
And if memory is not enough, you can set `force_col_wise=true`.
[LightGBM] [Info] Total Bins 4833
[LightGBM] [Info] Number of data points in the train set: 49484, number of used features: 19
[LightGBM] [Info] [binary:BoostFromScore]: pavg=0.500000 -&gt; initscore=0.000000
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
Confusion Matrix:
[[10153   568]
 [ 3586   603]]

Classification Report:
              precision    recall  f1-score   support

         0.0       0.74      0.95      0.83     10721
         1.0       0.51      0.14      0.23      4189

    accuracy                           0.72     14910
   macro avg       0.63      0.55      0.53     14910
weighted avg       0.68      0.72      0.66     14910


Accuracy: 0.721
</code></pre>
</div>
</div>
<div class="cell markdown" id="Xy8ZWNSMmABJ">
<p>LightGBM with SMOTE</p>
<p>Precision: Churn = No (0.0): 0.74 Churn = Yes (1.0): 0.49</p>
<p>Recall: Churn = No (0.0): 0.94 Churn = Yes (1.0): 0.15</p>
<p>F1-score: Churn = No (0.0): 0.83 Churn = Yes (1.0): 0.23</p>
<p>Accuracy: 0.72</p>
<p>LightGBM achieved the highest accuracy (0.72) and recall for
non-churned customers (0.94), but like XGBoost, it had a low recall for
churned customers (0.15).</p>
</div>
<div class="cell code" data-execution_count="123"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:1000}"
id="zaBv22QWKnlv" data-outputId="22782e3f-0abb-4d9c-c8d5-afd6c13f033a">
<div class="sourceCode" id="cb102"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.models <span class="im">import</span> Sequential</span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.layers <span class="im">import</span> Conv1D, MaxPooling1D, Flatten, Dense, Dropout, BatchNormalization</span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.utils <span class="im">import</span> to_categorical</span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> classification_report, confusion_matrix</span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-11"><a href="#cb102-11" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> df.drop(<span class="st">&#39;Churn&#39;</span>, axis<span class="op">=</span><span class="dv">1</span>).values</span>
<span id="cb102-12"><a href="#cb102-12" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df[<span class="st">&#39;Churn&#39;</span>].values</span>
<span id="cb102-13"><a href="#cb102-13" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> StandardScaler()</span>
<span id="cb102-14"><a href="#cb102-14" aria-hidden="true" tabindex="-1"></a>X_scaled <span class="op">=</span> scaler.fit_transform(X)</span>
<span id="cb102-15"><a href="#cb102-15" aria-hidden="true" tabindex="-1"></a>X_scaled <span class="op">=</span> X_scaled.reshape((X_scaled.shape[<span class="dv">0</span>], X_scaled.shape[<span class="dv">1</span>], <span class="dv">1</span>))</span>
<span id="cb102-16"><a href="#cb102-16" aria-hidden="true" tabindex="-1"></a>y_categorical <span class="op">=</span> to_categorical(y, num_classes<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb102-17"><a href="#cb102-17" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X_scaled, y_categorical, test_size<span class="op">=</span><span class="fl">0.3</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb102-18"><a href="#cb102-18" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> Sequential([</span>
<span id="cb102-19"><a href="#cb102-19" aria-hidden="true" tabindex="-1"></a>    Conv1D(<span class="dv">64</span>, kernel_size<span class="op">=</span><span class="dv">2</span>, activation<span class="op">=</span><span class="st">&#39;relu&#39;</span>, input_shape<span class="op">=</span>(X_train.shape[<span class="dv">1</span>], <span class="dv">1</span>)),</span>
<span id="cb102-20"><a href="#cb102-20" aria-hidden="true" tabindex="-1"></a>    BatchNormalization(),</span>
<span id="cb102-21"><a href="#cb102-21" aria-hidden="true" tabindex="-1"></a>    MaxPooling1D(pool_size<span class="op">=</span><span class="dv">2</span>),</span>
<span id="cb102-22"><a href="#cb102-22" aria-hidden="true" tabindex="-1"></a>    Dropout(<span class="fl">0.3</span>),</span>
<span id="cb102-23"><a href="#cb102-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-24"><a href="#cb102-24" aria-hidden="true" tabindex="-1"></a>    Conv1D(<span class="dv">128</span>, kernel_size<span class="op">=</span><span class="dv">2</span>, activation<span class="op">=</span><span class="st">&#39;relu&#39;</span>),</span>
<span id="cb102-25"><a href="#cb102-25" aria-hidden="true" tabindex="-1"></a>    BatchNormalization(),</span>
<span id="cb102-26"><a href="#cb102-26" aria-hidden="true" tabindex="-1"></a>    MaxPooling1D(pool_size<span class="op">=</span><span class="dv">2</span>),</span>
<span id="cb102-27"><a href="#cb102-27" aria-hidden="true" tabindex="-1"></a>    Dropout(<span class="fl">0.3</span>),</span>
<span id="cb102-28"><a href="#cb102-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-29"><a href="#cb102-29" aria-hidden="true" tabindex="-1"></a>    Flatten(),</span>
<span id="cb102-30"><a href="#cb102-30" aria-hidden="true" tabindex="-1"></a>    Dense(<span class="dv">64</span>, activation<span class="op">=</span><span class="st">&#39;relu&#39;</span>),</span>
<span id="cb102-31"><a href="#cb102-31" aria-hidden="true" tabindex="-1"></a>    Dropout(<span class="fl">0.3</span>),</span>
<span id="cb102-32"><a href="#cb102-32" aria-hidden="true" tabindex="-1"></a>    Dense(<span class="dv">2</span>, activation<span class="op">=</span><span class="st">&#39;softmax&#39;</span>)</span>
<span id="cb102-33"><a href="#cb102-33" aria-hidden="true" tabindex="-1"></a>])</span>
<span id="cb102-34"><a href="#cb102-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-35"><a href="#cb102-35" aria-hidden="true" tabindex="-1"></a>model.<span class="bu">compile</span>(optimizer<span class="op">=</span><span class="st">&#39;adam&#39;</span>, loss<span class="op">=</span><span class="st">&#39;categorical_crossentropy&#39;</span>, metrics<span class="op">=</span>[<span class="st">&#39;accuracy&#39;</span>])</span>
<span id="cb102-36"><a href="#cb102-36" aria-hidden="true" tabindex="-1"></a>history <span class="op">=</span> model.fit(X_train, y_train, epochs<span class="op">=</span><span class="dv">20</span>, batch_size<span class="op">=</span><span class="dv">32</span>, validation_data<span class="op">=</span>(X_test, y_test))</span>
<span id="cb102-37"><a href="#cb102-37" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> model.predict(X_test)</span>
<span id="cb102-38"><a href="#cb102-38" aria-hidden="true" tabindex="-1"></a>y_pred_classes <span class="op">=</span> np.argmax(y_pred, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb102-39"><a href="#cb102-39" aria-hidden="true" tabindex="-1"></a>y_test_classes <span class="op">=</span> np.argmax(y_test, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb102-40"><a href="#cb102-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-41"><a href="#cb102-41" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Confusion Matrix:&quot;</span>)</span>
<span id="cb102-42"><a href="#cb102-42" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(confusion_matrix(y_test_classes, y_pred_classes))</span>
<span id="cb102-43"><a href="#cb102-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-44"><a href="#cb102-44" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Classification Report:&quot;</span>)</span>
<span id="cb102-45"><a href="#cb102-45" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y_test_classes, y_pred_classes))</span>
<span id="cb102-46"><a href="#cb102-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-47"><a href="#cb102-47" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb102-48"><a href="#cb102-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-49"><a href="#cb102-49" aria-hidden="true" tabindex="-1"></a>plt.plot(history.history[<span class="st">&#39;accuracy&#39;</span>])</span>
<span id="cb102-50"><a href="#cb102-50" aria-hidden="true" tabindex="-1"></a>plt.plot(history.history[<span class="st">&#39;val_accuracy&#39;</span>])</span>
<span id="cb102-51"><a href="#cb102-51" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Model accuracy&#39;</span>)</span>
<span id="cb102-52"><a href="#cb102-52" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Accuracy&#39;</span>)</span>
<span id="cb102-53"><a href="#cb102-53" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Epoch&#39;</span>)</span>
<span id="cb102-54"><a href="#cb102-54" aria-hidden="true" tabindex="-1"></a>plt.legend([<span class="st">&#39;Train&#39;</span>, <span class="st">&#39;Test&#39;</span>], loc<span class="op">=</span><span class="st">&#39;upper left&#39;</span>)</span>
<span id="cb102-55"><a href="#cb102-55" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb102-56"><a href="#cb102-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-57"><a href="#cb102-57" aria-hidden="true" tabindex="-1"></a>plt.plot(history.history[<span class="st">&#39;loss&#39;</span>])</span>
<span id="cb102-58"><a href="#cb102-58" aria-hidden="true" tabindex="-1"></a>plt.plot(history.history[<span class="st">&#39;val_loss&#39;</span>])</span>
<span id="cb102-59"><a href="#cb102-59" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Model loss&#39;</span>)</span>
<span id="cb102-60"><a href="#cb102-60" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Loss&#39;</span>)</span>
<span id="cb102-61"><a href="#cb102-61" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Epoch&#39;</span>)</span>
<span id="cb102-62"><a href="#cb102-62" aria-hidden="true" tabindex="-1"></a>plt.legend([<span class="st">&#39;Train&#39;</span>, <span class="st">&#39;Test&#39;</span>], loc<span class="op">=</span><span class="st">&#39;upper left&#39;</span>)</span>
<span id="cb102-63"><a href="#cb102-63" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output stream stderr">
<pre><code>/usr/local/lib/python3.10/dist-packages/keras/src/layers/convolutional/base_conv.py:107: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(activity_regularizer=activity_regularizer, **kwargs)
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>Epoch 1/20
1088/1088 ━━━━━━━━━━━━━━━━━━━━ 11s 7ms/step - accuracy: 0.6824 - loss: 0.6843 - val_accuracy: 0.7191 - val_loss: 0.5851
Epoch 2/20
1088/1088 ━━━━━━━━━━━━━━━━━━━━ 13s 12ms/step - accuracy: 0.7085 - loss: 0.5987 - val_accuracy: 0.7178 - val_loss: 0.5819
Epoch 3/20
1088/1088 ━━━━━━━━━━━━━━━━━━━━ 21s 12ms/step - accuracy: 0.7136 - loss: 0.5873 - val_accuracy: 0.7184 - val_loss: 0.5836
Epoch 4/20
1088/1088 ━━━━━━━━━━━━━━━━━━━━ 20s 12ms/step - accuracy: 0.7139 - loss: 0.5878 - val_accuracy: 0.7192 - val_loss: 0.5793
Epoch 5/20
1088/1088 ━━━━━━━━━━━━━━━━━━━━ 21s 12ms/step - accuracy: 0.7169 - loss: 0.5844 - val_accuracy: 0.7193 - val_loss: 0.5805
Epoch 6/20
1088/1088 ━━━━━━━━━━━━━━━━━━━━ 8s 7ms/step - accuracy: 0.7137 - loss: 0.5845 - val_accuracy: 0.7196 - val_loss: 0.5766
Epoch 7/20
1088/1088 ━━━━━━━━━━━━━━━━━━━━ 11s 8ms/step - accuracy: 0.7129 - loss: 0.5858 - val_accuracy: 0.7192 - val_loss: 0.5791
Epoch 8/20
1088/1088 ━━━━━━━━━━━━━━━━━━━━ 11s 9ms/step - accuracy: 0.7135 - loss: 0.5844 - val_accuracy: 0.7193 - val_loss: 0.5770
Epoch 9/20
1088/1088 ━━━━━━━━━━━━━━━━━━━━ 8s 7ms/step - accuracy: 0.7134 - loss: 0.5841 - val_accuracy: 0.7195 - val_loss: 0.5779
Epoch 10/20
1088/1088 ━━━━━━━━━━━━━━━━━━━━ 10s 7ms/step - accuracy: 0.7071 - loss: 0.5880 - val_accuracy: 0.7199 - val_loss: 0.5748
Epoch 11/20
1088/1088 ━━━━━━━━━━━━━━━━━━━━ 9s 9ms/step - accuracy: 0.7107 - loss: 0.5864 - val_accuracy: 0.7200 - val_loss: 0.5734
Epoch 12/20
1088/1088 ━━━━━━━━━━━━━━━━━━━━ 8s 7ms/step - accuracy: 0.7140 - loss: 0.5835 - val_accuracy: 0.7198 - val_loss: 0.5739
Epoch 13/20
1088/1088 ━━━━━━━━━━━━━━━━━━━━ 10s 7ms/step - accuracy: 0.7117 - loss: 0.5834 - val_accuracy: 0.7207 - val_loss: 0.5775
Epoch 14/20
1088/1088 ━━━━━━━━━━━━━━━━━━━━ 11s 8ms/step - accuracy: 0.7171 - loss: 0.5816 - val_accuracy: 0.7186 - val_loss: 0.5727
Epoch 15/20
1088/1088 ━━━━━━━━━━━━━━━━━━━━ 11s 9ms/step - accuracy: 0.7126 - loss: 0.5814 - val_accuracy: 0.7202 - val_loss: 0.5711
Epoch 16/20
1088/1088 ━━━━━━━━━━━━━━━━━━━━ 8s 7ms/step - accuracy: 0.7122 - loss: 0.5850 - val_accuracy: 0.7191 - val_loss: 0.5740
Epoch 17/20
1088/1088 ━━━━━━━━━━━━━━━━━━━━ 9s 9ms/step - accuracy: 0.7109 - loss: 0.5828 - val_accuracy: 0.7194 - val_loss: 0.5723
Epoch 18/20
1088/1088 ━━━━━━━━━━━━━━━━━━━━ 9s 8ms/step - accuracy: 0.7119 - loss: 0.5843 - val_accuracy: 0.7203 - val_loss: 0.5731
Epoch 19/20
1088/1088 ━━━━━━━━━━━━━━━━━━━━ 9s 7ms/step - accuracy: 0.7159 - loss: 0.5770 - val_accuracy: 0.7205 - val_loss: 0.5729
Epoch 20/20
1088/1088 ━━━━━━━━━━━━━━━━━━━━ 11s 8ms/step - accuracy: 0.7163 - loss: 0.5784 - val_accuracy: 0.7192 - val_loss: 0.5733
466/466 ━━━━━━━━━━━━━━━━━━━━ 1s 2ms/step
Confusion Matrix:
[[10514   207]
 [ 3979   210]]

Classification Report:
              precision    recall  f1-score   support

           0       0.73      0.98      0.83     10721
           1       0.50      0.05      0.09      4189

    accuracy                           0.72     14910
   macro avg       0.61      0.52      0.46     14910
weighted avg       0.66      0.72      0.63     14910

</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_5cdade6e6d334c1a8623e96f9dd6155b/2c3a6f03ee4f90bd7a1408eb195306ec925d6b89.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_5cdade6e6d334c1a8623e96f9dd6155b/bd378ce6e0b08ac68d94463d25c7ead1bd6d49b0.png" /></p>
</div>
</div>
<div class="cell markdown" id="mm0FXTMZ6XIS">
<p>The model training results illustrate the following insights:</p>
<ol>
<li><p><strong>Model Accuracy and Loss</strong>: Throughout the 20
epochs, the training accuracy steadily improved, reaching around 71.9%,
while the test accuracy hovered around 71.8%. The training and
validation loss curves indicate a steady decrease, suggesting the
model’s training process is consistent and not overfitting
significantly.</p></li>
<li><p><strong>Confusion Matrix</strong>: The model performed well at
predicting non-churned customers (0), with 10,650 correctly classified
out of 10,704. However, it struggled with predicting churned customers
(1), correctly classifying only 76 out of 4,229. This suggests the model
is biased towards the majority class (non-churned customers).</p></li>
<li><p><strong>Classification Report</strong>:</p>
<ul>
<li><strong>Precision</strong> for non-churned customers (0) was high at
0.72, indicating that most customers predicted as non-churned were
correct.</li>
<li><strong>Recall</strong> for churned customers (1) was very low
(0.02), highlighting the model’s difficulty in capturing true churned
customers.</li>
<li><strong>Accuracy</strong> stands at 0.72, but this metric is largely
influenced by the model's high performance in identifying non-churned
customers.</li>
<li>The <strong>macro average F1-score</strong> is low, indicating the
model is imbalanced in class performance.</li>
</ul></li>
</ol>
</div>
<div class="cell markdown" id="gsr4gSHy65EN">
<p>The model trained over 20 epochs, demonstrating fluctuating
validation accuracy and loss. The training accuracy improved steadily,
reaching around 63%, while the validation accuracy varied between 52%
and 61%. The loss steadily decreased, indicating model learning, but
performance on validation data showed inconsistency.</p>
<p>The final accuracy was 59%, with the model showing better performance
in predicting non-churners (Class 0) with a precision of 77% and recall
of 60%. However, for churn prediction (Class 1), the precision was 35%
with a higher recall of 54%, indicating a trade-off. The model's overall
effectiveness in detecting churn is limited, with potential improvements
needed for better class balancing or feature engineering.</p>
</div>
</body>
</html>
